
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Project - Classification &#8212; My AI Notebook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=c1a6f12f" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=949a1ff5" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=ff8fa330"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=97881d71"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ds-courses/unsw/9417/9417-project';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Project - report" href="9417-report/report.html" />
    <link rel="prev" title="Basic with examples" href="9417-basic.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">My AI Notebook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://postsent.github.io/home/">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference.html">Acknowledgement</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Courses</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="9417-intro.html">Machine Learning (UNSW)</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="9417-basic.html">Basic with examples</a></li>







<li class="toctree-l2 current active"><a class="current reference internal" href="#">Project - Classification</a></li>








<li class="toctree-l2"><a class="reference internal" href="9417-report/report.html">Project - report</a></li>







</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../9418/9418-intro.html">PGM (UNSW)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../9418/9418-EDA.html">EDA on Times Series Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../9418/9418-project.html">Time series project code</a></li>






<li class="toctree-l2"><a class="reference internal" href="../9418/9418-project/report.html">Time series report</a></li>





</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../9517/9517-intro.html">Computer Vision (UNSW)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../9517/9517-a1-code.html">Basic image processing, thresholding, count cells</a></li>



<li class="toctree-l2"><a class="reference internal" href="../9517/9517-a1/report.html">Report on Basic image processing, etc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../9517/9517-lane_detection.html">Lane detection</a></li>





<li class="toctree-l2"><a class="reference internal" href="../9517/9517-vehicle-detection.html">Vehicle detection (by teammate)</a></li>




</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../9444/9444-intro.html">Deep Learning (UNSW)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../9444/9444-project.html">Image classification</a></li>








<li class="toctree-l2"><a class="reference internal" href="../9444/assignment1/assignment1.html">Characters, Spirals and Hidden Unit Dynamics</a></li>




















</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3900/3900-intro.html">Capstone (UNSW)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3900/project/3900-project.html"><strong>Chatbot</strong></a></li>






</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3431/3431-intro.html">ROS &amp; CV (UNSW)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3431/project/project.html">Mini self-driving</a></li>









</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../usyd/5046/5046-intro.html">NLP (USYD)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usyd/5046/a2/a2.html">Report - In-game Toxicity Detection</a></li>







<li class="toctree-l2"><a class="reference internal" href="../../usyd/5046/a2.html">In Game Toxicity seq2seq classification</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../usyd/5046/a1.html">Binary text classification</a></li>






</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../usyd/5349/5349-intro.html">Cloud Computing (USYD)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usyd/5349/a2/a2.html">Data Preprocessing and Performance Tuning with Spark</a></li>









<li class="toctree-l2"><a class="reference internal" href="../../usyd/5349/a2.html">Data Preprocessing and Performance Tuning with Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usyd/5349/a1.html">Text Analysis with Spark RDD API</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../usyd/5349/a1-report.html">Report – Text Analysis with Spark RDD API</a></li>






</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../usyd/5338/5338-intro.html">NoSQL &amp; Neo4j (USYD)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usyd/5338/a1.html">NoSQL basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usyd/5338/a2.html">NoSQL Aggregation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usyd/5338/a2-report/report.html"><strong>Performance Observation Task</strong></a></li>





<li class="toctree-l2"><a class="reference internal" href="../../usyd/5338/a3.html">Neo4j Basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usyd/5338/a4.html">Neo4j Query</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../usyd/5048/5048-intro.html">Visual Analytics Tableau (USYD)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usyd/5048/individual.html">Individual Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usyd/5048/group.html">Group Report (My part)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../usyd/5328/5328-intro.html">Advance ML (USYD)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usyd/5328/a1.html">NMF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usyd/5328/a2.html">Label Noise Learning</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../ml/regression/regression.html">Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../ml/regression/p1-crypto-prediction.html">Crypto Prediction</a></li>



</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ml/classification/classification.html">Classification (placeholder)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ml/time-series/time-series.html">Time Series (placeholder)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ml/ml.html">General</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Deep Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../dl/dl.html">General</a></li>





</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NLP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../nlp/nlp.html">placeholder</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer Vision</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../cv/cv.html">Placeholder</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../misc/math.html">Math</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../../misc/misc.html">Misc</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../../misc/term.html">Terminology</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../../misc/todo.html">TODO</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Coding Basic</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../python/basic-intro.html">Numpy, Pandas, Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../python/numpy.html">Numpy</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../../python/pandas.html">Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../python/leetcode.html">Leetcode</a></li>








</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Side Projects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../side-project/web-scrapter.html">Course Enrolment Scrapter</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unfinished</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../unfinished/pytorch-nlp-bk/nlp-book.html">NLP Book</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../unfinished/pytorch-nlp-bk/intro.html">Intro</a></li>













<li class="toctree-l2"><a class="reference internal" href="../../../unfinished/pytorch-nlp-bk/nn.html">Feed-Forward Networks for NLP</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../unfinished/pytorch-nlp-bk/prac-ch3.html">Chapter 3</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../unfinished/jigsaw-intro.html">Jigsaw</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../unfinished/jiagsaw-toxic-comment-serverity-rate/README.html">Folder Structure</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../unfinished/jiagsaw-toxic-comment-serverity-rate/notebooks/simple-rnn.html">Simple</a></li>













<li class="toctree-l2"><a class="reference internal" href="../../../unfinished/jiagsaw-toxic-comment-serverity-rate/notebooks/lstm.html">Upgrade RNN</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../../unfinished/jiagsaw-toxic-comment-serverity-rate/notebooks/helper.html">Common</a></li>

</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../unfinished/nlp-reading.html">Book Reading</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/postsent/home/main?urlpath=tree/docs/ds-courses/unsw/9417/9417-project.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/postsent/home" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/ds-courses/unsw/9417/9417-project.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Project - Classification</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Project - Classification</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-data">Explore data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-info">basic info</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values-boxplot-for-data">missing values, boxplot for data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#five-feature-pairwise-plot">five feature pairwise plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">boxplot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pie-chart-for-class-distribution">pie chart for class distribution</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-comparison">Model comparison</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-code">setup code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basedline-score">basedline score</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standarised-scores-0-mean">standarised scores (0 mean)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-result-for-final-model-choices">display result for final model choices</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-selection">Feature selection</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#features-correlation">features correlation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlated-with-y">correlated with y</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importance-using-extra-forest">Feature Importance using extra forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-based-feature-selection">Tree-based feature selection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-svm">linear SVM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pca">PCA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-comparison-using-pca">performance comparison using PCA</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anova-f-test">ANOVA f-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-square-test">chi-square test</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-outlier">Remove Outlier</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#isolation-forest">Isolation forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dbscan">DBSCAN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interquatile-range">Interquatile range</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-using-interqutertile">filter using interqutertile</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot-after-outlier-removal">boxplot after outlier removal</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-tuning">Parameter tuning</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">KNN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-tree">extra tree</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest">random forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">logistic regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mlp">MLP</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-on-validation-set">Testing on validation set</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGboost</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">extra tree</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visulisation">visulisation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">random forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">MLP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">KNN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Logistic Regression</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#voting-ensemble">Voting ensemble</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn-mlp-rf-et">KNN + MLP + RF + ET</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rf-et-mlp-not-used">RF + ET + MLP (not used)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-model-used-voting-ensemble-knn-mlp-rf-et">Submit - model used: voting ensemble (KNN + MLP + RF + ET)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-extra-tree-with-voting-ensemble">compare extra tree with voting ensemble</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#csv">csv</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Table of Contents<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Explore-data" data-toc-modified-id="Explore-data-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Explore data</a></span><ul class="toc-item"><li><span><a href="#basic-info" data-toc-modified-id="basic-info-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>basic info</a></span></li><li><span><a href="#missing-values,-boxplot-for-data" data-toc-modified-id="missing-values,-boxplot-for-data-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>missing values, boxplot for data</a></span><ul class="toc-item"><li><span><a href="#five-feature-pairwise-plot" data-toc-modified-id="five-feature-pairwise-plot-1.2.1"><span class="toc-item-num">1.2.1&nbsp;&nbsp;</span>five feature pairwise plot</a></span></li><li><span><a href="#boxplot" data-toc-modified-id="boxplot-1.2.2"><span class="toc-item-num">1.2.2&nbsp;&nbsp;</span>boxplot</a></span></li></ul></li><li><span><a href="#pie-chart-for-class-distribution" data-toc-modified-id="pie-chart-for-class-distribution-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>pie chart for class distribution</a></span></li></ul></li><li><span><a href="#Model-comparison" data-toc-modified-id="Model-comparison-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Model comparison</a></span><ul class="toc-item"><li><span><a href="#setup-code" data-toc-modified-id="setup-code-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>setup code</a></span></li><li><span><a href="#basedline-score" data-toc-modified-id="basedline-score-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>basedline score</a></span></li><li><span><a href="#standarised-scores-(0-mean)" data-toc-modified-id="standarised-scores-(0-mean)-2.3"><span class="toc-item-num">2.3&nbsp;&nbsp;</span>standarised scores (0 mean)</a></span></li><li><span><a href="#display-result-for-final-model-choices" data-toc-modified-id="display-result-for-final-model-choices-2.4"><span class="toc-item-num">2.4&nbsp;&nbsp;</span>display result for final model choices</a></span></li></ul></li><li><span><a href="#Feature-selection" data-toc-modified-id="Feature-selection-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Feature selection</a></span><ul class="toc-item"><li><span><a href="#features-correlation" data-toc-modified-id="features-correlation-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>features correlation</a></span></li><li><span><a href="#correlated-with-y" data-toc-modified-id="correlated-with-y-3.2"><span class="toc-item-num">3.2&nbsp;&nbsp;</span>correlated with y</a></span></li><li><span><a href="#Feature-Importance-using-extra-forest" data-toc-modified-id="Feature-Importance-using-extra-forest-3.3"><span class="toc-item-num">3.3&nbsp;&nbsp;</span>Feature Importance using extra forest</a></span></li><li><span><a href="#Tree-based-feature-selection" data-toc-modified-id="Tree-based-feature-selection-3.4"><span class="toc-item-num">3.4&nbsp;&nbsp;</span>Tree-based feature selection</a></span></li><li><span><a href="#linear-SVM" data-toc-modified-id="linear-SVM-3.5"><span class="toc-item-num">3.5&nbsp;&nbsp;</span>linear SVM</a></span></li><li><span><a href="#PCA" data-toc-modified-id="PCA-3.6"><span class="toc-item-num">3.6&nbsp;&nbsp;</span>PCA</a></span><ul class="toc-item"><li><span><a href="#performance-comparison-using-PCA" data-toc-modified-id="performance-comparison-using-PCA-3.6.1"><span class="toc-item-num">3.6.1&nbsp;&nbsp;</span>performance comparison using PCA</a></span></li></ul></li><li><span><a href="#ANOVA-f-test" data-toc-modified-id="ANOVA-f-test-3.7"><span class="toc-item-num">3.7&nbsp;&nbsp;</span>ANOVA f-test</a></span></li><li><span><a href="#chi-square-test" data-toc-modified-id="chi-square-test-3.8"><span class="toc-item-num">3.8&nbsp;&nbsp;</span>chi-square test</a></span></li></ul></li><li><span><a href="#Remove-Outlier" data-toc-modified-id="Remove-Outlier-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Remove Outlier</a></span><ul class="toc-item"><li><span><a href="#Isolation-forest" data-toc-modified-id="Isolation-forest-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Isolation forest</a></span></li><li><span><a href="#DBSCAN" data-toc-modified-id="DBSCAN-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>DBSCAN</a></span></li><li><span><a href="#Interquatile-range" data-toc-modified-id="Interquatile-range-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>Interquatile range</a></span><ul class="toc-item"><li><span><a href="#filter-using-interqutertile" data-toc-modified-id="filter-using-interqutertile-4.3.1"><span class="toc-item-num">4.3.1&nbsp;&nbsp;</span>filter using interqutertile</a></span></li><li><span><a href="#boxplot-after-outlier-removal" data-toc-modified-id="boxplot-after-outlier-removal-4.3.2"><span class="toc-item-num">4.3.2&nbsp;&nbsp;</span>boxplot after outlier removal</a></span></li></ul></li></ul></li><li><span><a href="#Parameter-tuning" data-toc-modified-id="Parameter-tuning-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Parameter tuning</a></span><ul class="toc-item"><li><span><a href="#KNN" data-toc-modified-id="KNN-5.1"><span class="toc-item-num">5.1&nbsp;&nbsp;</span>KNN</a></span></li><li><span><a href="#extra-tree" data-toc-modified-id="extra-tree-5.2"><span class="toc-item-num">5.2&nbsp;&nbsp;</span>extra tree</a></span></li><li><span><a href="#random-forest" data-toc-modified-id="random-forest-5.3"><span class="toc-item-num">5.3&nbsp;&nbsp;</span>random forest</a></span></li><li><span><a href="#logistic-regression" data-toc-modified-id="logistic-regression-5.4"><span class="toc-item-num">5.4&nbsp;&nbsp;</span>logistic regression</a></span></li><li><span><a href="#MLP" data-toc-modified-id="MLP-5.5"><span class="toc-item-num">5.5&nbsp;&nbsp;</span>MLP</a></span></li></ul></li><li><span><a href="#Testing-on-validation-set" data-toc-modified-id="Testing-on-validation-set-6"><span class="toc-item-num">6&nbsp;&nbsp;</span>Testing on validation set</a></span><ul class="toc-item"><li><span><a href="#XGboost" data-toc-modified-id="XGboost-6.1"><span class="toc-item-num">6.1&nbsp;&nbsp;</span>XGboost</a></span></li><li><span><a href="#extra-tree" data-toc-modified-id="extra-tree-6.2"><span class="toc-item-num">6.2&nbsp;&nbsp;</span>extra tree</a></span><ul class="toc-item"><li><span><a href="#visulisation" data-toc-modified-id="visulisation-6.2.1"><span class="toc-item-num">6.2.1&nbsp;&nbsp;</span>visulisation</a></span></li></ul></li><li><span><a href="#random-forest" data-toc-modified-id="random-forest-6.3"><span class="toc-item-num">6.3&nbsp;&nbsp;</span>random forest</a></span></li><li><span><a href="#MLP" data-toc-modified-id="MLP-6.4"><span class="toc-item-num">6.4&nbsp;&nbsp;</span>MLP</a></span></li><li><span><a href="#KNN" data-toc-modified-id="KNN-6.5"><span class="toc-item-num">6.5&nbsp;&nbsp;</span>KNN</a></span></li><li><span><a href="#Logistic-Regression" data-toc-modified-id="Logistic-Regression-6.6"><span class="toc-item-num">6.6&nbsp;&nbsp;</span>Logistic Regression</a></span></li></ul></li><li><span><a href="#Voting-ensemble" data-toc-modified-id="Voting-ensemble-7"><span class="toc-item-num">7&nbsp;&nbsp;</span>Voting ensemble</a></span><ul class="toc-item"><li><span><a href="#KNN-+-MLP-+-RF-+-ET" data-toc-modified-id="KNN-+-MLP-+-RF-+-ET-7.1"><span class="toc-item-num">7.1&nbsp;&nbsp;</span>KNN + MLP + RF + ET</a></span></li><li><span><a href="#RF-+-ET-+-MLP-(not-used)" data-toc-modified-id="RF-+-ET-+-MLP-(not-used)-7.2"><span class="toc-item-num">7.2&nbsp;&nbsp;</span>RF + ET + MLP (not used)</a></span></li></ul></li><li><span><a href="#Submit---model-used:-voting-ensemble-(KNN-+-MLP-+-RF-+-ET)" data-toc-modified-id="Submit---model-used:-voting-ensemble-(KNN-+-MLP-+-RF-+-ET)-8"><span class="toc-item-num">8&nbsp;&nbsp;</span>Submit - model used: voting ensemble (KNN + MLP + RF + ET)</a></span><ul class="toc-item"><li><span><a href="#compare-extra-tree-with-voting-ensemble" data-toc-modified-id="compare-extra-tree-with-voting-ensemble-8.1"><span class="toc-item-num">8.1&nbsp;&nbsp;</span>compare extra tree with voting ensemble</a></span></li><li><span><a href="#csv" data-toc-modified-id="csv-8.2"><span class="toc-item-num">8.2&nbsp;&nbsp;</span>csv</a></span></li></ul></li></ul></div><section class="tex2jax_ignore mathjax_ignore" id="project-classification">
<h1>Project - Classification<a class="headerlink" href="#project-classification" title="Link to this heading">#</a></h1>
<p>This is ML project done in COMP9417 where I practise the standard ML pipeline skill based on various sources mostly Kaggle.  Numerical Dataset is supplied.</p>
<p>TOC(2) nbextension is suggested to install for below section</p>
<p>External libraries are needed to run the below code:</p>
<ul class="simple">
<li><p>plotly</p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="explore-data">
<h1>Explore data<a class="headerlink" href="#explore-data" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  set a seed for reproducibility</span>
<span class="n">SEED</span> <span class="o">=</span> <span class="mi">23</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span> <span class="c1"># needed</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.offline</span> <span class="k">as</span> <span class="nn">py</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;style&gt;.container { width:80% !important; }&lt;/style&gt;&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<section id="basic-info">
<h2>basic info<a class="headerlink" href="#basic-info" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;X_train.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="c1"># ignore first row</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;y_train.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 8346 entries, 0 to 8345
Columns: 128 entries, 0 to 127
dtypes: float64(128)
memory usage: 8.2 MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>118</th>
      <th>119</th>
      <th>120</th>
      <th>121</th>
      <th>122</th>
      <th>123</th>
      <th>124</th>
      <th>125</th>
      <th>126</th>
      <th>127</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10549.4970</td>
      <td>4.649028</td>
      <td>2.167022</td>
      <td>2.752811</td>
      <td>3.352847</td>
      <td>-1.795881</td>
      <td>-2.245240</td>
      <td>-2.974630</td>
      <td>12602.3785</td>
      <td>5.147949</td>
      <td>...</td>
      <td>-20.068200</td>
      <td>-26.270819</td>
      <td>38700.2817</td>
      <td>10.894055</td>
      <td>15.934436</td>
      <td>39.024755</td>
      <td>44.534611</td>
      <td>-9.971828</td>
      <td>-15.614072</td>
      <td>-21.058869</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2255.0098</td>
      <td>1.216170</td>
      <td>0.783855</td>
      <td>2.127426</td>
      <td>7.283419</td>
      <td>-0.724791</td>
      <td>-1.369066</td>
      <td>-6.743371</td>
      <td>8654.2773</td>
      <td>1.516055</td>
      <td>...</td>
      <td>-2.006298</td>
      <td>-5.762565</td>
      <td>4930.2559</td>
      <td>1.796248</td>
      <td>2.230150</td>
      <td>4.773774</td>
      <td>13.361580</td>
      <td>-1.150931</td>
      <td>-1.843691</td>
      <td>-5.557387</td>
    </tr>
    <tr>
      <th>2</th>
      <td>73262.9595</td>
      <td>10.763480</td>
      <td>20.882685</td>
      <td>31.113756</td>
      <td>33.561047</td>
      <td>-14.626887</td>
      <td>-19.464937</td>
      <td>-32.201706</td>
      <td>72377.0762</td>
      <td>9.398184</td>
      <td>...</td>
      <td>-11.579332</td>
      <td>-16.558433</td>
      <td>27560.0596</td>
      <td>7.502004</td>
      <td>8.857011</td>
      <td>14.390461</td>
      <td>15.428557</td>
      <td>-6.604118</td>
      <td>-10.169493</td>
      <td>-14.197045</td>
    </tr>
    <tr>
      <th>3</th>
      <td>44069.7910</td>
      <td>5.043857</td>
      <td>11.894705</td>
      <td>16.865917</td>
      <td>29.003995</td>
      <td>-8.874675</td>
      <td>-21.002964</td>
      <td>-38.460729</td>
      <td>48995.5728</td>
      <td>9.506312</td>
      <td>...</td>
      <td>-10.738753</td>
      <td>-21.740832</td>
      <td>26450.5508</td>
      <td>8.056586</td>
      <td>11.630857</td>
      <td>32.422756</td>
      <td>40.659982</td>
      <td>-5.772124</td>
      <td>-9.061040</td>
      <td>-16.881837</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6860.3404</td>
      <td>2.485188</td>
      <td>2.068429</td>
      <td>3.070743</td>
      <td>7.140745</td>
      <td>-1.159993</td>
      <td>-1.749492</td>
      <td>-6.934935</td>
      <td>16921.8320</td>
      <td>2.999328</td>
      <td>...</td>
      <td>-12.316615</td>
      <td>-24.584155</td>
      <td>28181.7056</td>
      <td>7.791042</td>
      <td>14.848570</td>
      <td>46.932606</td>
      <td>60.231649</td>
      <td>-6.574350</td>
      <td>-10.693658</td>
      <td>-19.758951</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 128 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>118</th>
      <th>119</th>
      <th>120</th>
      <th>121</th>
      <th>122</th>
      <th>123</th>
      <th>124</th>
      <th>125</th>
      <th>126</th>
      <th>127</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>...</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
      <td>8346.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>49902.609741</td>
      <td>6.686965</td>
      <td>12.823958</td>
      <td>18.563598</td>
      <td>26.485375</td>
      <td>-9.074637</td>
      <td>-14.252376</td>
      <td>-58.334105</td>
      <td>56761.199769</td>
      <td>6.734881</td>
      <td>...</td>
      <td>-9.543014</td>
      <td>-18.853061</td>
      <td>19614.576609</td>
      <td>6.038451</td>
      <td>7.115541</td>
      <td>14.916599</td>
      <td>19.033853</td>
      <td>-4.874019</td>
      <td>-8.116945</td>
      <td>-15.877982</td>
    </tr>
    <tr>
      <th>std</th>
      <td>68758.941403</td>
      <td>16.299765</td>
      <td>17.434447</td>
      <td>24.649256</td>
      <td>36.984625</td>
      <td>12.544882</td>
      <td>20.958158</td>
      <td>126.214807</td>
      <td>63146.172361</td>
      <td>19.548788</td>
      <td>...</td>
      <td>9.055470</td>
      <td>25.366938</td>
      <td>14165.919618</td>
      <td>4.533910</td>
      <td>5.206196</td>
      <td>12.536898</td>
      <td>14.227420</td>
      <td>4.123172</td>
      <td>7.505155</td>
      <td>20.198504</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-16757.598600</td>
      <td>0.088287</td>
      <td>0.000100</td>
      <td>0.000100</td>
      <td>0.000100</td>
      <td>-127.407470</td>
      <td>-202.753097</td>
      <td>-1555.550631</td>
      <td>-16119.460900</td>
      <td>0.486850</td>
      <td>...</td>
      <td>-76.069200</td>
      <td>-442.004780</td>
      <td>-8297.548800</td>
      <td>0.712112</td>
      <td>0.003238</td>
      <td>0.025355</td>
      <td>0.202822</td>
      <td>-30.205911</td>
      <td>-58.773503</td>
      <td>-410.152297</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>6703.926650</td>
      <td>2.282439</td>
      <td>1.617982</td>
      <td>2.362283</td>
      <td>4.937769</td>
      <td>-11.558429</td>
      <td>-17.169820</td>
      <td>-48.275356</td>
      <td>13213.210225</td>
      <td>2.768536</td>
      <td>...</td>
      <td>-13.058462</td>
      <td>-22.194101</td>
      <td>8827.804825</td>
      <td>3.013723</td>
      <td>3.054586</td>
      <td>5.419981</td>
      <td>8.024146</td>
      <td>-6.699913</td>
      <td>-11.035601</td>
      <td>-18.753124</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>19188.954000</td>
      <td>3.804842</td>
      <td>4.936646</td>
      <td>7.239355</td>
      <td>11.638708</td>
      <td>-3.350116</td>
      <td>-4.964689</td>
      <td>-13.993678</td>
      <td>37556.756100</td>
      <td>4.720517</td>
      <td>...</td>
      <td>-7.369146</td>
      <td>-13.559079</td>
      <td>16328.503000</td>
      <td>4.984083</td>
      <td>5.804854</td>
      <td>11.328677</td>
      <td>14.580219</td>
      <td>-3.890385</td>
      <td>-6.331554</td>
      <td>-11.736492</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>62472.877800</td>
      <td>8.438259</td>
      <td>17.145460</td>
      <td>26.085503</td>
      <td>34.549582</td>
      <td>-1.121579</td>
      <td>-1.675425</td>
      <td>-5.205338</td>
      <td>69941.130150</td>
      <td>8.631187</td>
      <td>...</td>
      <td>-3.277017</td>
      <td>-7.385239</td>
      <td>26739.542550</td>
      <td>7.373897</td>
      <td>10.205102</td>
      <td>21.233618</td>
      <td>26.503304</td>
      <td>-1.810972</td>
      <td>-2.893410</td>
      <td>-6.471679</td>
    </tr>
    <tr>
      <th>max</th>
      <td>668677.085900</td>
      <td>1339.879283</td>
      <td>164.257913</td>
      <td>221.558494</td>
      <td>664.208067</td>
      <td>-0.021669</td>
      <td>-0.109067</td>
      <td>-0.475184</td>
      <td>502202.812500</td>
      <td>1672.363221</td>
      <td>...</td>
      <td>-0.136892</td>
      <td>-0.372947</td>
      <td>90328.637700</td>
      <td>40.470570</td>
      <td>31.835214</td>
      <td>297.225880</td>
      <td>97.042997</td>
      <td>-0.016275</td>
      <td>-0.062814</td>
      <td>-0.528959</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 128 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8346.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.392284</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.727710</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="missing-values-boxplot-for-data">
<h2>missing values, boxplot for data<a class="headerlink" href="#missing-values-boxplot-for-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># display n nan values</span>
<span class="n">indices_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">X_train</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;List the indices of the removed data points are&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">indices_nan</span><span class="p">))</span> <span class="c1"># if base csv, then this index + 2</span>
<span class="c1"># X_train = X_train.dropna() # remove rows if any conlumn contains nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>List the indices of the removed data points are []
</pre></div>
</div>
</div>
</div>
<section id="five-feature-pairwise-plot">
<h3>five feature pairwise plot<a class="headerlink" href="#five-feature-pairwise-plot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">][:</span><span class="mi">100</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/e8ca6d163d9a38877bc567be7de59471967fcd1be19af770a2fae41f3a1b59b1.png" src="../../../_images/e8ca6d163d9a38877bc567be7de59471967fcd1be19af770a2fae41f3a1b59b1.png" />
</div>
</div>
</section>
<section id="boxplot">
<h3>boxplot<a class="headerlink" href="#boxplot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fb48836431c4a66cc3e47d764a90a744e6aa93469e18280f15826362a29bee13.png" src="../../../_images/fb48836431c4a66cc3e47d764a90a744e6aa93469e18280f15826362a29bee13.png" />
</div>
</div>
</section>
</section>
<section id="pie-chart-for-class-distribution">
<h2>pie chart for class distribution<a class="headerlink" href="#pie-chart-for-class-distribution" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">PlotPie</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idxFeature</span><span class="p">):</span>

    <span class="n">trace</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Pie</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxFeature</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()],</span><span class="n">values</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxFeature</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
    <span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">([</span><span class="n">trace</span><span class="p">])</span>
    
<span class="n">PlotPie</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="8a14a07d-6703-46d0-94e1-be30bef2b883" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8a14a07d-6703-46d0-94e1-be30bef2b883")) {                    Plotly.newPlot(                        "8a14a07d-6703-46d0-94e1-be30bef2b883",                        [{"labels": ["2", "4", "5", "1", "3", "6"], "type": "pie", "values": [1785, 1758, 1525, 1170, 1114, 994]}],                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "autotypenumbers": "strict", "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('8a14a07d-6703-46d0-94e1-be30bef2b883');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="model-comparison">
<h1>Model comparison<a class="headerlink" href="#model-comparison" title="Link to this heading">#</a></h1>
<p>basedline, cross validation, data is normalised</p>
<section id="setup-code">
<h2>setup code<a class="headerlink" href="#setup-code" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load libraries</span>

<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">set_option</span>
<span class="c1">#from pandas.tools.plotting import scatter_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="kn">from</span> <span class="nn">sklearn.discriminant_analysis</span> <span class="kn">import</span> <span class="n">LinearDiscriminantAnalysis</span>

<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>

<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="k">def</span> <span class="nf">BasedLine2</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span><span class="n">models</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;f1_weighted&#39;</span><span class="p">):</span> <span class="c1"># marco bigger penalisation when  model does not perform well with the minority classes.</span>
    <span class="c1"># Test options and evaluation metric</span>
    <span class="n">num_folds</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">num_folds</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">cv_results</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">)</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cv_results</span><span class="p">)</span>
        <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: </span><span class="si">%f</span><span class="s2"> (</span><span class="si">%f</span><span class="s2">) (</span><span class="si">%0.4f</span><span class="s2">)s&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cv_results</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">cv_results</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">t</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">names</span><span class="p">,</span> <span class="n">results</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PlotBoxR</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__Trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nameOfFeature</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
    
        <span class="n">trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
            <span class="n">y</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">nameOfFeature</span><span class="p">,</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;rgb(0, 128, 128)&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">trace</span>

    <span class="k">def</span> <span class="nf">PlotResult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">):</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__Trace</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>


        <span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>


<span class="k">def</span> <span class="nf">GetBasedModel</span><span class="p">():</span>
    
    <span class="n">pipelines</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;LR&#39;</span>  <span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;LDA&#39;</span> <span class="p">,</span> <span class="n">LinearDiscriminantAnalysis</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;KNN&#39;</span> <span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;CART&#39;</span><span class="p">,</span> <span class="n">DecisionTreeClassifier</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;NB&#39;</span>  <span class="p">,</span> <span class="n">GaussianNB</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;SVM&#39;</span> <span class="p">,</span> <span class="n">SVC</span><span class="p">()),</span>
        <span class="c1">#(&#39;AB&#39;  , AdaBoostClassifier()),</span>
        <span class="p">(</span><span class="s1">&#39;DTR&#39;</span> <span class="p">,</span> <span class="n">DecisionTreeRegressor</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;RF&#39;</span>  <span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;ET&#39;</span>  <span class="p">,</span> <span class="n">ExtraTreesClassifier</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;NN&#39;</span>  <span class="p">,</span> <span class="n">MLPClassifier</span><span class="p">())</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">pipelines</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="k">def</span> <span class="nf">GetScaledModel</span><span class="p">(</span><span class="n">nameOfScaler</span><span class="p">,</span> <span class="n">is_final</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">onemodel</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    onemodel[0] - abbr of the model name</span>
<span class="sd">    [1] - the model</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">nameOfScaler</span> <span class="o">==</span> <span class="s1">&#39;standard&#39;</span><span class="p">:</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">nameOfScaler</span> <span class="o">==</span><span class="s1">&#39;minmax&#39;</span><span class="p">:</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">onemodel</span><span class="p">:</span>
        <span class="n">pipelines</span> <span class="o">=</span> <span class="p">[(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="n">onemodel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="n">onemodel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="p">,</span> <span class="n">onemodel</span><span class="p">[</span><span class="mi">1</span><span class="p">])])),]</span>
            
        <span class="k">return</span> <span class="n">pipelines</span> 
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_final</span><span class="p">:</span>
        <span class="n">pipelines</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;LR&#39;</span>  <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;LR&#39;</span>  <span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">())])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;LDA&#39;</span> <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;LDA&#39;</span> <span class="p">,</span> <span class="n">LinearDiscriminantAnalysis</span><span class="p">())])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;KNN&#39;</span> <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;KNN&#39;</span> <span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;CART&#39;</span><span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;CART&#39;</span><span class="p">,</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">))])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;NB&#39;</span>  <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;NB&#39;</span>  <span class="p">,</span> <span class="n">GaussianNB</span><span class="p">())])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;SVM&#39;</span> <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;SVM&#39;</span> <span class="p">,</span> <span class="n">SVC</span><span class="p">())])),</span>
            <span class="c1"># (nameOfScaler+&#39;AB&#39;  , Pipeline([(&#39;Scaler&#39;, scaler),(&#39;AB&#39;  , AdaBoostClassifier())])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;DTR&#39;</span> <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;DTR&#39;</span> <span class="p">,</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">))])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;RF&#39;</span>  <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;RF&#39;</span>  <span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">))])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;ET&#39;</span>  <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;ET&#39;</span>  <span class="p">,</span> <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">))])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;NN&#39;</span>  <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;NN&#39;</span>  <span class="p">,</span> <span class="n">MLPClassifier</span><span class="p">())]))</span> 
        <span class="p">]</span>
    
    <span class="k">else</span><span class="p">:</span>
         <span class="n">pipelines</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;LR&#39;</span>  <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;LR&#39;</span>  <span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">())])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;KNN&#39;</span> <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;KNN&#39;</span> <span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;RF&#39;</span>  <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;RF&#39;</span>  <span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">))])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;ET&#39;</span>  <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;ET&#39;</span>  <span class="p">,</span> <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">))])),</span>
            <span class="p">(</span><span class="n">nameOfScaler</span><span class="o">+</span><span class="s1">&#39;NN&#39;</span>  <span class="p">,</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;NN&#39;</span>  <span class="p">,</span> <span class="n">MLPClassifier</span><span class="p">())]))</span> 
         <span class="p">]</span>
        
    <span class="k">return</span> <span class="n">pipelines</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="basedline-score">
<h2>basedline score<a class="headerlink" href="#basedline-score" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">simplefilter</span>
<span class="kn">from</span> <span class="nn">sklearn.exceptions</span> <span class="kn">import</span> <span class="n">ConvergenceWarning</span>
<span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">ConvergenceWarning</span><span class="p">)</span>

<span class="n">models</span> <span class="o">=</span> <span class="n">GetBasedModel</span><span class="p">()</span>
<span class="n">names</span><span class="p">,</span><span class="n">results</span> <span class="o">=</span> <span class="n">BasedLine2</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span><span class="n">models</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LR: 0.947679 (0.011998) (12.2597)s
LDA: 0.942391 (0.007538) (4.1722)s
KNN: 0.974418 (0.006637) (3.6214)s
CART: 0.968064 (0.006383) (22.5111)s
NB: 0.566793 (0.013320) (0.8062)s
SVM: 0.854616 (0.020996) (63.6510)s
DTR: 0.962767 (0.005018) (22.2110)s
RF: 0.993770 (0.002269) (120.3873)s
ET: 0.995107 (0.002448) (21.8434)s
NN: 0.939384 (0.052470) (74.1383)s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ScoreDataFrame</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">floatingDecimals</span><span class="p">(</span><span class="n">f_val</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">prc</span> <span class="o">=</span> <span class="s2">&quot;{:.&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;f}&quot;</span> 
    
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">prc</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f_val</span><span class="p">))</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">floatingDecimals</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="mi">4</span><span class="p">))</span>

    <span class="n">scoreDataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Model&#39;</span><span class="p">:</span><span class="n">names</span><span class="p">,</span> <span class="s1">&#39;Score&#39;</span><span class="p">:</span> <span class="n">scores</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">scoreDataFrame</span>
<span class="n">basedLineScore</span> <span class="o">=</span> <span class="n">ScoreDataFrame</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
<span class="n">basedLineScore</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>LR</td>
      <td>0.9477</td>
    </tr>
    <tr>
      <th>1</th>
      <td>LDA</td>
      <td>0.9424</td>
    </tr>
    <tr>
      <th>2</th>
      <td>KNN</td>
      <td>0.9744</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CART</td>
      <td>0.9681</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NB</td>
      <td>0.5668</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SVM</td>
      <td>0.8546</td>
    </tr>
    <tr>
      <th>6</th>
      <td>DTR</td>
      <td>0.9628</td>
    </tr>
    <tr>
      <th>7</th>
      <td>RF</td>
      <td>0.9938</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ET</td>
      <td>0.9951</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NN</td>
      <td>0.9394</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PlotBoxR</span><span class="p">()</span><span class="o">.</span><span class="n">PlotResult</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="41a13614-1fd5-44b0-bfa6-71b12fa37d0f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("41a13614-1fd5-44b0-bfa6-71b12fa37d0f")) {                    Plotly.newPlot(                        "41a13614-1fd5-44b0-bfa6-71b12fa37d0f",                        [{"marker": {"color": "rgb(0, 128, 128)"}, "name": "LR", "type": "box", "y": [0.9362848575799648, 0.9284915548228362, 0.9521169402065848, 0.9446975687031033, 0.9571427191786777, 0.9579501024330517, 0.9303068193425558, 0.9602284902576103, 0.9459128748217026, 0.9636593915421251]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "LDA", "type": "box", "y": [0.9376067683208361, 0.939836672104375, 0.9516282812862769, 0.9513032140299957, 0.9293843285065438, 0.9455280603246708, 0.9329808082787155, 0.9525657385678526, 0.940652283750715, 0.9424254886576916]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "KNN", "type": "box", "y": [0.9686020225829174, 0.9772520250075342, 0.9833816424355831, 0.9776935808721655, 0.9801707572564978, 0.9751882652004977, 0.9759913597551607, 0.97472814527405, 0.9579920600703616, 0.973182705051101]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "CART", "type": "box", "y": [0.9640546608747348, 0.9597197893931382, 0.9668534613217304, 0.9755131802183926, 0.9746150194513067, 0.9664503125275564, 0.9670184903709907, 0.9627753673525256, 0.9628205342714221, 0.9808209950492347]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "NB", "type": "box", "y": [0.5353703620535676, 0.5793150253721243, 0.5806556186454215, 0.5724979241500439, 0.5767282734322234, 0.561567552758878, 0.5758731303514554, 0.5550573076308708, 0.5601605575531771, 0.5706999135381167]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "SVM", "type": "box", "y": [0.8414963268364287, 0.8097189350171147, 0.8727082307673327, 0.8572171717666098, 0.8592325932234516, 0.869745445885408, 0.8452394628526206, 0.880151563423979, 0.8341710250388766, 0.8764840252297813]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "DTR", "type": "box", "y": [0.960249870660272, 0.9664305149721426, 0.959772972990196, 0.9678987209860067, 0.9706369900990386, 0.9652371428393395, 0.9552572963035314, 0.9670092143357997, 0.9581461876904078, 0.9570291856444553]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "RF", "type": "box", "y": [0.9914964625791293, 0.9945933650572174, 0.9941748066748066, 0.9977401532063371, 0.9902478134318445, 0.9913101087104925, 0.9928055912868182, 0.994798657514634, 0.9937162508527336, 0.9968159244507543]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "ET", "type": "box", "y": [0.9929590360692372, 0.9972276437926267, 0.9973638618666536, 0.9977401532063371, 0.9936582037866198, 0.9954077155114672, 0.9938232939834589, 0.9948773150435973, 0.9899761015923554, 0.9980343175521575]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "NN", "type": "box", "y": [0.9465433695931615, 0.8979166611071637, 0.8082773930457868, 0.9862558445113793, 0.9832418220286653, 0.9851586585693864, 0.9754404189162765, 0.9572563667398927, 0.9123261231400371, 0.9414237584341953]}],                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "autotypenumbers": "strict", "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('41a13614-1fd5-44b0-bfa6-71b12fa37d0f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
</section>
<section id="standarised-scores-0-mean">
<h2>standarised scores (0 mean)<a class="headerlink" href="#standarised-scores-0-mean" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="n">GetScaledModel</span><span class="p">(</span><span class="s1">&#39;standard&#39;</span><span class="p">)</span>
<span class="n">names</span><span class="p">,</span><span class="n">results</span> <span class="o">=</span> <span class="n">BasedLine2</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span><span class="n">models</span><span class="p">)</span>
<span class="n">scaledScoreStandard</span> <span class="o">=</span> <span class="n">ScoreDataFrame</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>standardLR: 0.990608 (0.001836) (12.4744)s
standardLDA: 0.942391 (0.007538) (4.6974)s
standardKNN: 0.989289 (0.004484) (4.2760)s
standardCART: 0.968311 (0.006938) (23.6182)s
standardNB: 0.579093 (0.012989) (1.1911)s
standardSVM: 0.968308 (0.005243) (32.5496)s
standardDTR: 0.962989 (0.007792) (20.5385)s
standardRF: 0.993926 (0.002135) (56.1106)s
standardET: 0.995543 (0.001721) (7.4755)s
standardNN: 0.994608 (0.002563) (122.6768)s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compareModels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">basedLineScore</span><span class="p">,</span>
                           <span class="n">scaledScoreStandard</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">compareModels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Score</th>
      <th>Model</th>
      <th>Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>LR</td>
      <td>0.9477</td>
      <td>standardLR</td>
      <td>0.9906</td>
    </tr>
    <tr>
      <th>1</th>
      <td>LDA</td>
      <td>0.9424</td>
      <td>standardLDA</td>
      <td>0.9424</td>
    </tr>
    <tr>
      <th>2</th>
      <td>KNN</td>
      <td>0.9744</td>
      <td>standardKNN</td>
      <td>0.9893</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CART</td>
      <td>0.9681</td>
      <td>standardCART</td>
      <td>0.9683</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NB</td>
      <td>0.5668</td>
      <td>standardNB</td>
      <td>0.5791</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SVM</td>
      <td>0.8546</td>
      <td>standardSVM</td>
      <td>0.9683</td>
    </tr>
    <tr>
      <th>6</th>
      <td>DTR</td>
      <td>0.9628</td>
      <td>standardDTR</td>
      <td>0.9630</td>
    </tr>
    <tr>
      <th>7</th>
      <td>RF</td>
      <td>0.9938</td>
      <td>standardRF</td>
      <td>0.9939</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ET</td>
      <td>0.9951</td>
      <td>standardET</td>
      <td>0.9955</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NN</td>
      <td>0.9394</td>
      <td>standardNN</td>
      <td>0.9946</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PlotBoxR</span><span class="p">()</span><span class="o">.</span><span class="n">PlotResult</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="a350fe4f-2155-4ca1-b0af-3e0cbac6e224" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a350fe4f-2155-4ca1-b0af-3e0cbac6e224")) {                    Plotly.newPlot(                        "a350fe4f-2155-4ca1-b0af-3e0cbac6e224",                        [{"marker": {"color": "rgb(0, 128, 128)"}, "name": "standardLR", "type": "box", "y": [0.9906708106466987, 0.9891415314037131, 0.990777791294148, 0.9922135116729344, 0.9885536008752918, 0.9877410260762419, 0.9909006004634175, 0.9942922955218196, 0.9897388073172234, 0.9920540142335629]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "standardLDA", "type": "box", "y": [0.9376067683208361, 0.939836672104375, 0.9516282812862769, 0.9513032140299957, 0.9293843285065438, 0.9455280603246708, 0.9329808082787155, 0.9525657385678526, 0.940652283750715, 0.9424254886576916]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "standardKNN", "type": "box", "y": [0.9867585227861952, 0.9935549605782302, 0.9852435129017024, 0.9960687211251428, 0.9873355841086465, 0.9886519050781909, 0.9974996717894129, 0.9867762412101605, 0.9835688053292407, 0.9874329990972024]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "standardCART", "type": "box", "y": [0.9678084109739965, 0.964193648766645, 0.9644702713616186, 0.9835883588198198, 0.9776085598693154, 0.9631982643673269, 0.9695710954283759, 0.9597845035791638, 0.9631117808731363, 0.9697767892457326]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "standardNB", "type": "box", "y": [0.5520023747998196, 0.5953059432233715, 0.5871252321055802, 0.5880922316889169, 0.5699820067950871, 0.577767025351367, 0.5902836027593098, 0.5808778258307878, 0.5626259057748118, 0.5868686883062089]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "standardSVM", "type": "box", "y": [0.9644229467716136, 0.958470639063711, 0.9692351748848803, 0.9751602660001714, 0.9673199692620223, 0.9726021349324022, 0.969836649381339, 0.9621793638966132, 0.9680711054314516, 0.9757789016624896]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "standardDTR", "type": "box", "y": [0.9561644963210693, 0.9645597334541361, 0.9581114214514416, 0.9710685781675036, 0.9778397535321984, 0.9680891587325308, 0.9517207806289143, 0.9673050594236497, 0.9604277748287195, 0.9546003967137201]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "standardRF", "type": "box", "y": [0.9901111768584733, 0.9959121869930946, 0.9944445921312405, 0.9962835491927251, 0.9902478134318445, 0.9943900505130131, 0.9941150810326396, 0.9935802790655881, 0.993560669746938, 0.9966150188496558]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "standardET", "type": "box", "y": [0.9929590360692372, 0.9972276437926267, 0.9956301879591644, 0.9977401532063371, 0.9960959844170908, 0.9954077155114672, 0.9928055912868182, 0.9948773150435973, 0.9946554713694842, 0.9980343175521575]}, {"marker": {"color": "rgb(0, 128, 128)"}, "name": "standardNN", "type": "box", "y": [0.9939418630675462, 0.9959503773063094, 0.9940666936213635, 0.998413235570596, 0.9950782852428391, 0.9962666462696727, 0.9906551038752779, 0.9977480438067078, 0.9901946313042709, 0.9937608880286319]}],                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "autotypenumbers": "strict", "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a350fe4f-2155-4ca1-b0af-3e0cbac6e224');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
</section>
<section id="display-result-for-final-model-choices">
<h2>display result for final model choices<a class="headerlink" href="#display-result-for-final-model-choices" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="n">GetScaledModel</span><span class="p">(</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="n">is_final</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">names</span><span class="p">,</span><span class="n">results</span> <span class="o">=</span> <span class="n">BasedLine2</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span><span class="n">models</span><span class="p">)</span>
<span class="n">scaledScoreStandard</span> <span class="o">=</span> <span class="n">ScoreDataFrame</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>standardLR: 0.990891 (0.001795) (13.9465)s
standardKNN: 0.989689 (0.004457) (4.5513)s
standardRF: 0.994486 (0.001871) (119.9082)s
standardET: 0.995206 (0.001858) (21.8076)s
standardNN: 0.994726 (0.001873) (345.6130)s
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="feature-selection">
<h1>Feature selection<a class="headerlink" href="#feature-selection" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>(Numerical Input, Categorical Output)</p></li>
</ul>
<section id="features-correlation">
<h2>features correlation<a class="headerlink" href="#features-correlation" title="Link to this heading">#</a></h2>
<p>Too many featrure and so heatmap not done yet</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create correlation matrix</span>
<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

<span class="c1"># Select upper triangle of correlation matrix</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">corr_matrix</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">))</span>

<span class="n">thresh</span> <span class="o">=</span> <span class="mf">0.99</span>
<span class="c1"># Find features with correlation greater than 0</span>
<span class="n">X_train_corr_idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">upper</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">thresh</span><span class="p">)]</span>
<span class="n">X_train_corr</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">X_train_corr_idx</span><span class="p">]</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">X_train_corr</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">fignum</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X_train_corr</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;number&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">X_train_corr</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;number&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X_train_corr</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;number&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">X_train_corr</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;number&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation Matrix&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/3c93ecec3d9dfa36da6ec58ffd8de732a0b31942242485f7b578f5f45e1486eb.png" src="../../../_images/3c93ecec3d9dfa36da6ec58ffd8de732a0b31942242485f7b578f5f45e1486eb.png" />
</div>
</div>
</section>
<section id="correlated-with-y">
<h2>correlated with y<a class="headerlink" href="#correlated-with-y" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> 
<span class="n">corr_mx</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">corr_target</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">corr_mx</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">relevant_features</span> <span class="o">=</span> <span class="n">corr_target</span><span class="p">[</span><span class="n">corr_target</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">relevant_features</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;feature 107 is highly correlated with the output variable y&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>107    0.508849
y      1.000000
Name: y, dtype: float64
feature 107 is highly correlated with the output variable y
</pre></div>
</div>
</div>
</div>
</section>
<section id="feature-importance-using-extra-forest">
<h2>Feature Importance using extra forest<a class="headerlink" href="#feature-importance-using-extra-forest" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>  <span class="c1"># https://scikit-learn.org/stable/modules/feature_selection.html</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="c1"># #############################################################################</span>
<span class="c1"># Plot feature importance</span>
<span class="n">feature_importance</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">feature_importances_</span>
<span class="c1"># make importances relative to max importance</span>
<span class="n">feature_importance</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">feature_importance</span> <span class="o">/</span> <span class="n">feature_importance</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">sorted_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">feature_importance</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sorted_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># start from 1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">feature_importance</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">])</span><span class="c1">#boston.feature_names[sorted_idx])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Relative Importance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Variable Importance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/952b02fe591412b092491be27b567b589a98db253bfa6061954525ef05287d85.png" src="../../../_images/952b02fe591412b092491be27b567b589a98db253bfa6061954525ef05287d85.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">],</span> <span class="n">feature_importance</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/7ac8deab3ea2caadbc637735173d9462ed9c78886fa4b061e281678b7c07c19f.png" src="../../../_images/7ac8deab3ea2caadbc637735173d9462ed9c78886fa4b061e281678b7c07c19f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">pos_10</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">sorted_idx_10</span> <span class="o">=</span> <span class="n">sorted_idx</span><span class="p">[</span><span class="mi">128</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">pos_10</span><span class="p">,</span> <span class="n">feature_importance</span><span class="p">[</span><span class="n">sorted_idx_10</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">pos_10</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">sorted_idx_10</span><span class="p">])</span> <span class="c1">#boston.feature_names[sorted_idx])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Relative Importance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Tree feature Importance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/b7090fcd57abf037d787ea4638be6cc89cc99511157e07293e9fe1315580b4fd.png" src="../../../_images/b7090fcd57abf037d787ea4638be6cc89cc99511157e07293e9fe1315580b4fd.png" />
</div>
</div>
</section>
<section id="tree-based-feature-selection">
<h2>Tree-based feature selection<a class="headerlink" href="#tree-based-feature-selection" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectFromModel</span>

<span class="n">extra_tree</span> <span class="o">=</span> <span class="n">SelectFromModel</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">prefit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train_uncorrelated</span> <span class="o">=</span> <span class="n">extra_tree</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train_uncorrelated</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8346, 128)
(8346, 54)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="n">GetScaledModel</span><span class="p">(</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="n">is_final</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">names</span><span class="p">,</span><span class="n">results</span> <span class="o">=</span> <span class="n">BasedLine2</span><span class="p">(</span><span class="n">X_train_uncorrelated</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="p">,</span><span class="n">models</span><span class="p">)</span>
<span class="n">scaledScoreUncorrelated</span> <span class="o">=</span> <span class="n">ScoreDataFrame</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>standardLR: 0.987305 (0.003035) (8.2355)s
standardKNN: 0.990414 (0.003742) (3.5546)s
standardRF: 0.993648 (0.002835) (77.1212)s
standardET: 0.994850 (0.002680) (16.0384)s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:619: UserWarning:

Training interrupted by user.

c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:619: UserWarning:

Training interrupted by user.

c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:619: UserWarning:

Training interrupted by user.

c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:619: UserWarning:

Training interrupted by user.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>standardNN: 0.990644 (0.004610) (168.6174)s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="n">GetScaledModel</span><span class="p">(</span><span class="s1">&#39;minmax&#39;</span><span class="p">)</span>

<span class="n">names</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">BasedLine2</span><span class="p">(</span><span class="n">X_train_uncorrelated</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">models</span><span class="p">)</span>
<span class="n">scaledScoreUncorrelated</span> <span class="o">=</span> <span class="n">ScoreDataFrame</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># tree based</span>
<span class="n">standardLR</span><span class="p">:</span> <span class="mf">0.988388</span> <span class="p">(</span><span class="mf">0.002939</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.5770</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardLDA</span><span class="p">:</span> <span class="mf">0.936282</span> <span class="p">(</span><span class="mf">0.011338</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.5000</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardKNN</span><span class="p">:</span> <span class="mf">0.989694</span> <span class="p">(</span><span class="mf">0.003474</span><span class="p">)</span> <span class="p">(</span><span class="mf">1.5740</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardCART</span><span class="p">:</span> <span class="mf">0.969004</span> <span class="p">(</span><span class="mf">0.007555</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.0900</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardNB</span><span class="p">:</span> <span class="mf">0.653904</span> <span class="p">(</span><span class="mf">0.011444</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.1730</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardSVM</span><span class="p">:</span> <span class="mf">0.971762</span> <span class="p">(</span><span class="mf">0.004988</span><span class="p">)</span> <span class="p">(</span><span class="mf">9.8190</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardDTR</span><span class="p">:</span> <span class="mf">0.968384</span> <span class="p">(</span><span class="mf">0.004151</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.6700</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardRF</span><span class="p">:</span> <span class="mf">0.993290</span> <span class="p">(</span><span class="mf">0.002944</span><span class="p">)</span> <span class="p">(</span><span class="mf">23.5940</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardET</span><span class="p">:</span> <span class="mf">0.995328</span> <span class="p">(</span><span class="mf">0.002173</span><span class="p">)</span> <span class="p">(</span><span class="mf">5.4410</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardNN</span><span class="p">:</span> <span class="mf">0.994249</span> <span class="p">(</span><span class="mf">0.002719</span><span class="p">)</span> <span class="p">(</span><span class="mf">85.5400</span><span class="p">)</span><span class="n">s</span>
<span class="c1"># tree based</span>
<span class="n">minmaxLR</span><span class="p">:</span> <span class="mf">0.929561</span> <span class="p">(</span><span class="mf">0.013392</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.5490</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxLDA</span><span class="p">:</span> <span class="mf">0.936282</span> <span class="p">(</span><span class="mf">0.011338</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.4920</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxKNN</span><span class="p">:</span> <span class="mf">0.991497</span> <span class="p">(</span><span class="mf">0.003797</span><span class="p">)</span> <span class="p">(</span><span class="mf">1.3530</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxCART</span><span class="p">:</span> <span class="mf">0.968645</span> <span class="p">(</span><span class="mf">0.007678</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.9610</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxNB</span><span class="p">:</span> <span class="mf">0.653746</span> <span class="p">(</span><span class="mf">0.011244</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.1310</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxSVM</span><span class="p">:</span> <span class="mf">0.924977</span> <span class="p">(</span><span class="mf">0.009184</span><span class="p">)</span> <span class="p">(</span><span class="mf">17.9440</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxDTR</span><span class="p">:</span> <span class="mf">0.969581</span> <span class="p">(</span><span class="mf">0.004976</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.5860</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxRF</span><span class="p">:</span> <span class="mf">0.992931</span> <span class="p">(</span><span class="mf">0.003003</span><span class="p">)</span> <span class="p">(</span><span class="mf">23.4960</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxET</span><span class="p">:</span> <span class="mf">0.995328</span> <span class="p">(</span><span class="mf">0.002173</span><span class="p">)</span> <span class="p">(</span><span class="mf">5.4340</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxNN</span><span class="p">:</span> <span class="mf">0.990418</span> <span class="p">(</span><span class="mf">0.003632</span><span class="p">)</span> <span class="p">(</span><span class="mf">85.1250</span><span class="p">)</span><span class="n">s</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="linear-svm">
<h2>linear SVM<a class="headerlink" href="#linear-svm" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="n">lsvc</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s2">&quot;l1&quot;</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">lsvc</span> <span class="o">=</span> <span class="n">SelectFromModel</span><span class="p">(</span><span class="n">lsvc</span><span class="p">,</span> <span class="n">prefit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\svm\_base.py:985: ConvergenceWarning:

Liblinear failed to converge, increase the number of iterations.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_uncorrelated</span> <span class="o">=</span> <span class="n">lsvc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train_uncorrelated</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8346, 128)
(8346, 85)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="n">GetScaledModel</span><span class="p">(</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="n">is_final</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">names</span><span class="p">,</span><span class="n">results</span> <span class="o">=</span> <span class="n">BasedLine2</span><span class="p">(</span><span class="n">X_train_uncorrelated</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="p">,</span><span class="n">models</span><span class="p">)</span>
<span class="n">scaledScoreUncorrelated</span> <span class="o">=</span> <span class="n">ScoreDataFrame</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>standardLR: 0.988626 (0.002570) (8.8474)s
standardKNN: 0.988606 (0.004489) (3.9037)s
standardRF: 0.993885 (0.002649) (106.1228)s
standardET: 0.994967 (0.001843) (21.2378)s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:619: UserWarning:

Training interrupted by user.

c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:619: UserWarning:

Training interrupted by user.

c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:619: UserWarning:

Training interrupted by user.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>standardNN: 0.993894 (0.002531) (208.9675)s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="n">GetScaledModel</span><span class="p">(</span><span class="s1">&#39;minmax&#39;</span><span class="p">)</span>

<span class="n">names</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">BasedLine2</span><span class="p">(</span><span class="n">X_train_uncorrelated</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">models</span><span class="p">)</span>
<span class="n">scaledScoreUncorrelated</span> <span class="o">=</span> <span class="n">ScoreDataFrame</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># linear svm</span>
<span class="n">standardLR</span><span class="p">:</span> <span class="mf">0.988271</span> <span class="p">(</span><span class="mf">0.002957</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.2990</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardLDA</span><span class="p">:</span> <span class="mf">0.935625</span> <span class="p">(</span><span class="mf">0.008560</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.9490</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardKNN</span><span class="p">:</span> <span class="mf">0.988488</span> <span class="p">(</span><span class="mf">0.004889</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.2280</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardCART</span><span class="p">:</span> <span class="mf">0.967651</span> <span class="p">(</span><span class="mf">0.005911</span><span class="p">)</span> <span class="p">(</span><span class="mf">4.7810</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardNB</span><span class="p">:</span> <span class="mf">0.628579</span> <span class="p">(</span><span class="mf">0.008900</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.2740</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardSVM</span><span class="p">:</span> <span class="mf">0.970788</span> <span class="p">(</span><span class="mf">0.005237</span><span class="p">)</span> <span class="p">(</span><span class="mf">16.2470</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardDTR</span><span class="p">:</span> <span class="mf">0.965663</span> <span class="p">(</span><span class="mf">0.004823</span><span class="p">)</span> <span class="p">(</span><span class="mf">4.0070</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardRF</span><span class="p">:</span> <span class="mf">0.994126</span> <span class="p">(</span><span class="mf">0.002236</span><span class="p">)</span> <span class="p">(</span><span class="mf">30.4280</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardET</span><span class="p">:</span> <span class="mf">0.994847</span> <span class="p">(</span><span class="mf">0.002147</span><span class="p">)</span> <span class="p">(</span><span class="mf">6.7770</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardNN</span><span class="p">:</span> <span class="mf">0.994368</span> <span class="p">(</span><span class="mf">0.001699</span><span class="p">)</span> <span class="p">(</span><span class="mf">91.4530</span><span class="p">)</span><span class="n">s</span>
<span class="c1"># linear svm</span>
<span class="n">minmaxLR</span><span class="p">:</span> <span class="mf">0.921744</span> <span class="p">(</span><span class="mf">0.013821</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.5190</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxLDA</span><span class="p">:</span> <span class="mf">0.935625</span> <span class="p">(</span><span class="mf">0.008560</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.7570</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxKNN</span><span class="p">:</span> <span class="mf">0.989935</span> <span class="p">(</span><span class="mf">0.004794</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.5760</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxCART</span><span class="p">:</span> <span class="mf">0.966932</span> <span class="p">(</span><span class="mf">0.005766</span><span class="p">)</span> <span class="p">(</span><span class="mf">4.6940</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxNB</span><span class="p">:</span> <span class="mf">0.628579</span> <span class="p">(</span><span class="mf">0.008900</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.2070</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxSVM</span><span class="p">:</span> <span class="mf">0.856650</span> <span class="p">(</span><span class="mf">0.013341</span><span class="p">)</span> <span class="p">(</span><span class="mf">37.7310</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxDTR</span><span class="p">:</span> <span class="mf">0.965901</span> <span class="p">(</span><span class="mf">0.004860</span><span class="p">)</span> <span class="p">(</span><span class="mf">4.0230</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxRF</span><span class="p">:</span> <span class="mf">0.994126</span> <span class="p">(</span><span class="mf">0.002236</span><span class="p">)</span> <span class="p">(</span><span class="mf">30.2350</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxET</span><span class="p">:</span> <span class="mf">0.994847</span> <span class="p">(</span><span class="mf">0.002147</span><span class="p">)</span> <span class="p">(</span><span class="mf">6.7730</span><span class="p">)</span><span class="n">s</span>
<span class="n">minmaxNN</span><span class="p">:</span> <span class="mf">0.989569</span> <span class="p">(</span><span class="mf">0.002992</span><span class="p">)</span> <span class="p">(</span><span class="mf">88.8660</span><span class="p">)</span><span class="n">s</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pca">
<h2>PCA<a class="headerlink" href="#pca" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PCA(n_components=10)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 5.76065368e-01  2.65241082e-05  1.43867855e-04 ... -2.17320572e-05
  -3.64640349e-05 -7.03968423e-05]
 [ 3.06310778e-01 -5.86722154e-05  4.74822702e-05 ...  8.85680949e-05
   1.51617144e-04  2.81127057e-04]
 [-7.50329296e-01  1.59275796e-05 -2.10930809e-04 ...  1.53977537e-05
   1.50835406e-05 -5.89398533e-05]
 ...
 [ 1.72098395e-02  2.85677134e-04  1.67333601e-04 ... -1.07253287e-04
  -2.57659687e-04 -6.47063308e-04]
 [-3.13571699e-03  2.74625253e-04 -4.77280842e-05 ...  1.34234071e-04
   4.95425377e-04  2.12559716e-03]
 [ 1.48738163e-03  3.73692663e-04 -3.81673733e-04 ...  1.80522914e-05
   3.23034802e-04  2.64016226e-03]]
[1.33352772e+10 9.17632115e+08 3.83786292e+08 1.61250897e+08
 2.17759430e+07 8.22843468e+06 6.05233871e+06 2.68196474e+06
 1.04531316e+06 5.70298637e+05]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;PCA - number of components&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;cumulative explained variance&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;cumulative explained variance&#39;)
</pre></div>
</div>
<img alt="../../../_images/592b2290ee7d892a843efb4114949bc8cf082c8be83c325f76c773392783eb0d.png" src="../../../_images/592b2290ee7d892a843efb4114949bc8cf082c8be83c325f76c773392783eb0d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;original shape:   &quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;transformed shape:&quot;</span><span class="p">,</span> <span class="n">X_pca</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>original shape:    (8346, 128)
transformed shape: (8346, 10)
</pre></div>
</div>
</div>
</div>
<section id="performance-comparison-using-pca">
<h3>performance comparison using PCA<a class="headerlink" href="#performance-comparison-using-pca" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">n_features</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">]:</span>
    <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_features</span><span class="p">)</span>
    <span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">GetScaledModel</span><span class="p">(</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="n">is_final</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n_features = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_features</span><span class="p">))</span>
    <span class="n">names</span><span class="p">,</span><span class="n">results</span> <span class="o">=</span> <span class="n">BasedLine2</span><span class="p">(</span><span class="n">X_pca</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">models</span><span class="p">)</span>
    <span class="n">scaledScoreUncorrelated</span> <span class="o">=</span> <span class="n">ScoreDataFrame</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># result</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">standardLR</span><span class="p">:</span> <span class="mf">0.963734</span> <span class="p">(</span><span class="mf">0.004937</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.5460</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardKNN</span><span class="p">:</span> <span class="mf">0.992207</span> <span class="p">(</span><span class="mf">0.003687</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.4720</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardRF</span><span class="p">:</span> <span class="mf">0.994005</span> <span class="p">(</span><span class="mf">0.002149</span><span class="p">)</span> <span class="p">(</span><span class="mf">11.1300</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardET</span><span class="p">:</span> <span class="mf">0.995564</span> <span class="p">(</span><span class="mf">0.002146</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.4390</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardNN</span><span class="p">:</span> <span class="mf">0.994612</span> <span class="p">(</span><span class="mf">0.002526</span><span class="p">)</span> <span class="p">(</span><span class="mf">81.4890</span><span class="p">)</span><span class="n">s</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">standardLR</span><span class="p">:</span> <span class="mf">0.974999</span> <span class="p">(</span><span class="mf">0.007364</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.2830</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardKNN</span><span class="p">:</span> <span class="mf">0.993167</span> <span class="p">(</span><span class="mf">0.003261</span><span class="p">)</span> <span class="p">(</span><span class="mf">1.2290</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardRF</span><span class="p">:</span> <span class="mf">0.995324</span> <span class="p">(</span><span class="mf">0.002240</span><span class="p">)</span> <span class="p">(</span><span class="mf">14.6100</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardET</span><span class="p">:</span> <span class="mf">0.996525</span> <span class="p">(</span><span class="mf">0.001248</span><span class="p">)</span> <span class="p">(</span><span class="mf">4.4630</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardNN</span><span class="p">:</span> <span class="mf">0.994970</span> <span class="p">(</span><span class="mf">0.003067</span><span class="p">)</span> <span class="p">(</span><span class="mf">85.5540</span><span class="p">)</span><span class="n">s</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">standardLR</span><span class="p">:</span> <span class="mf">0.983006</span> <span class="p">(</span><span class="mf">0.003419</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.7440</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardKNN</span><span class="p">:</span> <span class="mf">0.990292</span> <span class="p">(</span><span class="mf">0.004061</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.1570</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardRF</span><span class="p">:</span> <span class="mf">0.994962</span> <span class="p">(</span><span class="mf">0.001995</span><span class="p">)</span> <span class="p">(</span><span class="mf">18.2360</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardET</span><span class="p">:</span> <span class="mf">0.996646</span> <span class="p">(</span><span class="mf">0.001915</span><span class="p">)</span> <span class="p">(</span><span class="mf">5.3520</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardNN</span><span class="p">:</span> <span class="mf">0.993415</span> <span class="p">(</span><span class="mf">0.003085</span><span class="p">)</span> <span class="p">(</span><span class="mf">66.8380</span><span class="p">)</span><span class="n">s</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">standardLR</span><span class="p">:</span> <span class="mf">0.984557</span> <span class="p">(</span><span class="mf">0.002779</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.4510</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardKNN</span><span class="p">:</span> <span class="mf">0.988021</span> <span class="p">(</span><span class="mf">0.003556</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.0570</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardRF</span><span class="p">:</span> <span class="mf">0.995563</span> <span class="p">(</span><span class="mf">0.002012</span><span class="p">)</span> <span class="p">(</span><span class="mf">21.5390</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardET</span><span class="p">:</span> <span class="mf">0.996406</span> <span class="p">(</span><span class="mf">0.001515</span><span class="p">)</span> <span class="p">(</span><span class="mf">6.0720</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardNN</span><span class="p">:</span> <span class="mf">0.992576</span> <span class="p">(</span><span class="mf">0.004990</span><span class="p">)</span> <span class="p">(</span><span class="mf">58.1020</span><span class="p">)</span><span class="n">s</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">standardLR</span><span class="p">:</span> <span class="mf">0.987072</span> <span class="p">(</span><span class="mf">0.003370</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.7980</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardKNN</span><span class="p">:</span> <span class="mf">0.986588</span> <span class="p">(</span><span class="mf">0.003155</span><span class="p">)</span> <span class="p">(</span><span class="mf">4.4080</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardRF</span><span class="p">:</span> <span class="mf">0.994842</span> <span class="p">(</span><span class="mf">0.002406</span><span class="p">)</span> <span class="p">(</span><span class="mf">25.0940</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardET</span><span class="p">:</span> <span class="mf">0.996406</span> <span class="p">(</span><span class="mf">0.001778</span><span class="p">)</span> <span class="p">(</span><span class="mf">6.8930</span><span class="p">)</span><span class="n">s</span>
<span class="n">standardNN</span><span class="p">:</span> <span class="mf">0.992110</span> <span class="p">(</span><span class="mf">0.004276</span><span class="p">)</span> <span class="p">(</span><span class="mf">53.7570</span><span class="p">)</span><span class="n">s</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">standardLR_lines</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.963734</span><span class="p">,</span> <span class="mf">0.974999</span><span class="p">,</span> <span class="mf">0.983006</span><span class="p">,</span> <span class="mf">0.984557</span><span class="p">,</span> <span class="mf">0.987072</span><span class="p">]</span>
<span class="n">standardKNN_lines</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.992207</span><span class="p">,</span> <span class="mf">0.993167</span><span class="p">,</span> <span class="mf">0.990292</span><span class="p">,</span> <span class="mf">0.988021</span><span class="p">,</span> <span class="mf">0.986588</span><span class="p">]</span>
<span class="n">standardRF_lines</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.994005</span><span class="p">,</span> <span class="mf">0.995324</span><span class="p">,</span> <span class="mf">0.994962</span><span class="p">,</span> <span class="mf">0.995563</span><span class="p">,</span> <span class="mf">0.994842</span><span class="p">]</span>
<span class="n">standardET_lines</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.995564</span><span class="p">,</span> <span class="mf">0.996525</span><span class="p">,</span> <span class="mf">0.996646</span><span class="p">,</span> <span class="mf">0.996406</span><span class="p">,</span> <span class="mf">0.996406</span><span class="p">]</span>
<span class="n">standardNN_lines</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.994612</span><span class="p">,</span> <span class="mf">0.994970</span><span class="p">,</span> <span class="mf">0.993415</span><span class="p">,</span> <span class="mf">0.992576</span><span class="p">,</span> <span class="mf">0.992110</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
<span class="c1"># plot lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">standardLR_lines</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;standardLR&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">standardLR_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.001</span><span class="p">,</span> <span class="s2">&quot;standardLR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">standardKNN_lines</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;standardKNN&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">standardKNN_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="s2">&quot;standardKNN&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">standardRF_lines</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;standardRF&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">standardRF_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;standardRF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">standardET_lines</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;standardET&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">standardET_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;standardET&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">standardNN_lines</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;standardNN&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">standardNN_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;standardNN&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of PCA component vs F1-scores on 10 folds&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of PCA component&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Weighted F1-score&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/a27c68ec51af453ff82d5371936377f38037037218e910f97547b31380f0548d.png" src="../../../_images/a27c68ec51af453ff82d5371936377f38037037218e910f97547b31380f0548d.png" />
</div>
</div>
</section>
</section>
<section id="anova-f-test">
<h2>ANOVA f-test<a class="headerlink" href="#anova-f-test" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">f_classif</span>

<span class="k">def</span> <span class="nf">select_features</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">):</span>
    <span class="c1"># configure to select all features</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span><span class="o">=</span><span class="n">f_classif</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
    <span class="c1"># learn relationship from training data</span>
    <span class="n">fs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="c1"># transform train input data</span>
    <span class="n">X_train_fs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="c1"># transform test input data</span>
    
    <span class="k">return</span> <span class="n">X_train_fs</span><span class="p">,</span> <span class="n">fs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_fs</span><span class="p">,</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">select_features</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">scores_</span><span class="p">))],</span> <span class="n">fs</span><span class="o">.</span><span class="n">scores_</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/65d543bbd261c0e767f46951b34f4b1e118b3b69ddc1709754397eed5c7dfde2.png" src="../../../_images/65d543bbd261c0e767f46951b34f4b1e118b3b69ddc1709754397eed5c7dfde2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sorted_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># start from 1</span>
<span class="n">pos_10</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>

<span class="c1"># top 10 important feature</span>
<span class="n">anova_idx</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">scores_</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="n">anova_values</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">scores_</span><span class="p">[</span><span class="n">anova_idx</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">pos_10</span><span class="p">,</span> <span class="n">anova_values</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">pos_10</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">anova_idx</span><span class="p">])</span><span class="c1">#boston.feature_names[sorted_idx])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Importance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ANOVA feature Importance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/8e383190802f8b90e12d981d05da11266cba60bfa096c2f41f8961e7862bf8c1.png" src="../../../_images/8e383190802f8b90e12d981d05da11266cba60bfa096c2f41f8961e7862bf8c1.png" />
</div>
</div>
</section>
<section id="chi-square-test">
<h2>chi-square test<a class="headerlink" href="#chi-square-test" title="Link to this heading">#</a></h2>
<p>not applied as positive x value only</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">chi2</span>

<span class="n">chi_scores</span> <span class="o">=</span> <span class="n">chi2</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">p_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">chi_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">p_values</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">269</span><span class="o">-</span><span class="mi">8</span><span class="n">f7ee91c5fe1</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">chi2</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">chi_scores</span> <span class="o">=</span> <span class="n">chi2</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">p_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">chi_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\feature_selection\_univariate_selection.py</span> in <span class="ni">chi2</span><span class="nt">(X, y)</span>
<span class="g g-Whitespace">    </span><span class="mi">215</span>     <span class="n">X</span> <span class="o">=</span> <span class="n">check_array</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">accept_sparse</span><span class="o">=</span><span class="s1">&#39;csr&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span>     <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">data</span> <span class="k">if</span> <span class="n">issparse</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="k">else</span> <span class="n">X</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">217</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input X must be non-negative.&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span> 
<span class="g g-Whitespace">    </span><span class="mi">219</span>     <span class="n">Y</span> <span class="o">=</span> <span class="n">LabelBinarizer</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="ne">ValueError</span>: Input X must be non-negative.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="remove-outlier">
<h1>Remove Outlier<a class="headerlink" href="#remove-outlier" title="Link to this heading">#</a></h1>
<section id="isolation-forest">
<h2>Isolation forest<a class="headerlink" href="#isolation-forest" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">IsolationForest</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">make_scorer</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>

<span class="n">iso</span> <span class="o">=</span> <span class="n">IsolationForest</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">iso</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_cleaned</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)]</span>
<span class="n">y_train_cleaned</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># summarize the shape of the updated training dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train_cleaned</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train_cleaned</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">cleaned</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">X_train_cleaned</span><span class="o">.</span><span class="n">shape</span>

<span class="n">total</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;number of outlier row removed: &quot;</span><span class="p">,</span> <span class="n">total</span> <span class="o">-</span> <span class="n">cleaned</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;percentage of outliers removed: &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">cleaned</span><span class="p">)</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(7317, 128) (7317, 1)
number of outlier row removed:  1029
percentage of outliers removed:  0.12329259525521208
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">X_train_cleaned</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/ff7fce7c25412c0c0e72ef077a8fd0c954ae095916681a45b9d4ea74630f3323.png" src="../../../_images/ff7fce7c25412c0c0e72ef077a8fd0c954ae095916681a45b9d4ea74630f3323.png" />
</div>
</div>
</section>
<section id="dbscan">
<h2>DBSCAN<a class="headerlink" href="#dbscan" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">DBSCAN</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[[</span><span class="mi">107</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">107</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">labels_</span>
<span class="n">outliers</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">db</span><span class="o">.</span><span class="n">labels_</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># print(outliers)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            107        10 
0      7.114660   2.791684
1      2.377768   3.429237
2      5.511479  21.934918
3      6.945802  13.186184
4      8.146852   6.116002
...         ...        ...
8341  10.420015  12.599138
8342   4.465969   3.121286
8343  13.482777  33.433897
8344   1.652638   8.963939
8345   2.924476  18.432145

[8346 rows x 2 columns]
</pre></div>
</div>
<img alt="../../../_images/a4e6a0b33d9fcbeaf95c54146b14d8dd875a8d1f07b6ee93f083731aed0b67f5.png" src="../../../_images/a4e6a0b33d9fcbeaf95c54146b14d8dd875a8d1f07b6ee93f083731aed0b67f5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_cleaned</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">db</span><span class="o">.</span><span class="n">labels_</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y_train_cleaned</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">[</span><span class="n">db</span><span class="o">.</span><span class="n">labels_</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">X_train_cleaned</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fbfc1ac5ad7afb195311f72fd7727696c27af8756cf21ad9ff46b5f2972b97a8.png" src="../../../_images/fbfc1ac5ad7afb195311f72fd7727696c27af8756cf21ad9ff46b5f2972b97a8.png" />
</div>
</div>
</section>
<section id="interquatile-range">
<h2>Interquatile range<a class="headerlink" href="#interquatile-range" title="Link to this heading">#</a></h2>
<p>Numerical features preprocessing is different for tree and non tree model.</p>
<ol class="arabic simple">
<li><p>Usually:</p></li>
</ol>
<ul class="simple">
<li><p>Tree based models does not depend on scaling</p></li>
<li><p>Non-tree based models hugely depend on scaling</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Most Often used preprocening are:</p></li>
</ol>
<ul class="simple">
<li><p>MinMax scaler to [0,1]</p></li>
<li><p>Standard Scaler to mean = 0 and std =1</p></li>
<li><p>Rank (We do not work on it in this data set)</p></li>
<li><p>Using np.log(1+data),  np.sqrt(data) and stats.boxcox(data) (for exp dependency)</p></li>
</ul>
<p>let’s try some of them and see how our model prediction change by scalling</p>
<section id="filter-using-interqutertile">
<h3>filter using interqutertile<a class="headerlink" href="#filter-using-interqutertile" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">quantile</span>
<span class="c1"># calculate interquartile range</span>
<span class="c1"># https://stackoverflow.com/questions/50461349/how-to-remove-outlier-from-dataframe-using-iqr</span>
<span class="k">def</span> <span class="nf">remove_outlier_IQR</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">Q1</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">Q3</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">IQR</span><span class="o">=</span><span class="n">Q3</span><span class="o">-</span><span class="n">Q1</span>
    <span class="n">thresh</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="n">df_final</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">df</span><span class="o">&lt;</span><span class="p">(</span><span class="n">Q1</span><span class="o">-</span><span class="n">thresh</span><span class="o">*</span><span class="n">IQR</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Q3</span><span class="o">+</span><span class="n">thresh</span><span class="o">*</span><span class="n">IQR</span><span class="p">)))</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">df_final</span>                          
    
<span class="n">cleaned</span> <span class="o">=</span> <span class="n">remove_outlier_IQR</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">n</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">shape</span>
<span class="n">total</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n removed:&quot;</span><span class="p">,</span> <span class="n">total</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;perc:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">total</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n removed: 2949
perc: 0.3533429187634795
</pre></div>
</div>
</div>
</div>
</section>
<section id="boxplot-after-outlier-removal">
<h3>boxplot after outlier removal<a class="headerlink" href="#boxplot-after-outlier-removal" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">cleaned</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/8b6f4fd8dfded58a5ba4836c1a6cf1bbcc8e2111ab753a28725942ed8ce4cc87.png" src="../../../_images/8b6f4fd8dfded58a5ba4836c1a6cf1bbcc8e2111ab753a28725942ed8ce4cc87.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="parameter-tuning">
<h1>Parameter tuning<a class="headerlink" href="#parameter-tuning" title="Link to this heading">#</a></h1>
<p>The time consuming ones such as tree model and MLP are tuned on colab, so only results are copied and paste below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="knn">
<h2>KNN<a class="headerlink" href="#knn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">KNN_model</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;n_neighbors&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">KNN_GridSearch</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">KNN_model</span><span class="p">,</span> 
                              <span class="n">param_grid</span><span class="p">,</span> 
                              <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">,</span> 
                              <span class="n">cv</span><span class="o">=</span><span class="mi">10</span>
                              <span class="p">)</span>
<span class="n">KNN_GridSearch</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">KNN_GridSearch</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">KNN_GridSearch</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KNeighborsClassifier(n_neighbors=1)
0.9942531402504736
</pre></div>
</div>
</div>
</div>
</section>
<section id="extra-tree">
<h2>extra tree<a class="headerlink" href="#extra-tree" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">make_scorer</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>  <span class="c1"># https://scikit-learn.org/stable/modules/feature_selection.html</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">],</span>
              <span class="s2">&quot;max_features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
              <span class="s2">&quot;min_samples_split&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
              <span class="s2">&quot;min_samples_leaf&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
              <span class="s2">&quot;bootstrap&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">],</span>
              <span class="s2">&quot;n_estimators&quot;</span> <span class="p">:[</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">],</span>
              <span class="s2">&quot;criterion&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;gini&quot;</span><span class="p">]}</span>

<span class="n">grid_dt_estimator</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> 
                                                 <span class="n">param_grid</span><span class="p">,</span>
                                                 <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">,</span> 
                                                 <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                 <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                                                 <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">grid_dt_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="c1"># ExtraTreesClassifier(criterion=&#39;gini&#39;, max_depth=None, max_features=10,</span>
<span class="c1">#                      min_samples_leaf=1, min_samples_split=2,n_estimators=300,random_state=SEED)</span>
<span class="c1"># 0.9955660187635302</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">73</span><span class="o">-</span><span class="n">a07cd2fa1d3b</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span>                                                  <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span>                                                  <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">20</span> <span class="n">grid_dt_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\utils\validation.py</span> in <span class="ni">inner_f</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span>             <span class="n">extra_args</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_args</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span>             <span class="k">if</span> <span class="n">extra_args</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">63</span>                 <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> 
<span class="g g-Whitespace">     </span><span class="mi">65</span>             <span class="c1"># extra_args &gt; 0</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\model_selection\_search.py</span> in <span class="ni">fit</span><span class="nt">(self, X, y, groups, **fit_params)</span>
<span class="g g-Whitespace">    </span><span class="mi">839</span>                 <span class="k">return</span> <span class="n">results</span>
<span class="g g-Whitespace">    </span><span class="mi">840</span> 
<span class="ne">--&gt; </span><span class="mi">841</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_run_search</span><span class="p">(</span><span class="n">evaluate_candidates</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">842</span> 
<span class="g g-Whitespace">    </span><span class="mi">843</span>             <span class="c1"># multimetric is determined here because in the case of a callable</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\model_selection\_search.py</span> in <span class="ni">_run_search</span><span class="nt">(self, evaluate_candidates)</span>
<span class="g g-Whitespace">   </span><span class="mi">1286</span>     <span class="k">def</span> <span class="nf">_run_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evaluate_candidates</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1287</span><span class="w">         </span><span class="sd">&quot;&quot;&quot;Search all candidates in param_grid&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1288</span>         <span class="n">evaluate_candidates</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">1289</span> 
<span class="g g-Whitespace">   </span><span class="mi">1290</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\model_selection\_search.py</span> in <span class="ni">evaluate_candidates</span><span class="nt">(candidate_params, cv, more_results)</span>
<span class="g g-Whitespace">    </span><span class="mi">793</span>                               <span class="n">n_splits</span><span class="p">,</span> <span class="n">n_candidates</span><span class="p">,</span> <span class="n">n_candidates</span> <span class="o">*</span> <span class="n">n_splits</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span> 
<span class="ne">--&gt; </span><span class="mi">795</span>                 <span class="n">out</span> <span class="o">=</span> <span class="n">parallel</span><span class="p">(</span><span class="n">delayed</span><span class="p">(</span><span class="n">_fit_and_score</span><span class="p">)(</span><span class="n">clone</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span>                                                        <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">797</span>                                                        <span class="n">train</span><span class="o">=</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">,</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">   </span><span class="mi">1042</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_iterating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_iterator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1043</span> 
<span class="ne">-&gt; </span><span class="mi">1044</span>             <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_one_batch</span><span class="p">(</span><span class="n">iterator</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1045</span>                 <span class="k">pass</span>
<span class="g g-Whitespace">   </span><span class="mi">1046</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">dispatch_one_batch</span><span class="nt">(self, iterator)</span>
<span class="g g-Whitespace">    </span><span class="mi">857</span>                 <span class="k">return</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span>             <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">859</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_dispatch</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span>                 <span class="k">return</span> <span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">861</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">_dispatch</span><span class="nt">(self, batch)</span>
<span class="g g-Whitespace">    </span><span class="mi">775</span>         <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">776</span>             <span class="n">job_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_jobs</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">777</span>             <span class="n">job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">cb</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">778</span>             <span class="c1"># A job can complete so quickly than its callback is</span>
<span class="g g-Whitespace">    </span><span class="mi">779</span>             <span class="c1"># called before we get here, causing self._jobs to</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\_parallel_backends.py</span> in <span class="ni">apply_async</span><span class="nt">(self, func, callback)</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>     <span class="k">def</span> <span class="nf">apply_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span><span class="w">         </span><span class="sd">&quot;&quot;&quot;Schedule a func to be run&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">208</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">ImmediateResult</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span>         <span class="k">if</span> <span class="n">callback</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span>             <span class="n">callback</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\_parallel_backends.py</span> in <span class="ni">__init__</span><span class="nt">(self, batch)</span>
<span class="g g-Whitespace">    </span><span class="mi">570</span>         <span class="c1"># Don&#39;t delay the application, to avoid keeping the input</span>
<span class="g g-Whitespace">    </span><span class="mi">571</span>         <span class="c1"># arguments in memory</span>
<span class="ne">--&gt; </span><span class="mi">572</span>         <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">batch</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">573</span> 
<span class="g g-Whitespace">    </span><span class="mi">574</span>     <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">__call__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="c1"># change the default number of processes to -1</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="k">with</span> <span class="n">parallel_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_jobs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">262</span>             <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span>                     <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="c1"># change the default number of processes to -1</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="k">with</span> <span class="n">parallel_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_jobs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">262</span>             <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span>                     <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\utils\fixes.py</span> in <span class="ni">__call__</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>     <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>         <span class="k">with</span> <span class="n">config_context</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">222</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\model_selection\_validation.py</span> in <span class="ni">_fit_and_score</span><span class="nt">(estimator, X, y, scorer, train, test, verbose, parameters, fit_params, return_train_score, return_parameters, return_n_test_samples, return_times, return_estimator, split_progress, candidate_progress, error_score)</span>
<span class="g g-Whitespace">    </span><span class="mi">591</span>             <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">592</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">593</span>             <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">594</span> 
<span class="g g-Whitespace">    </span><span class="mi">595</span>     <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\ensemble\_forest.py</span> in <span class="ni">fit</span><span class="nt">(self, X, y, sample_weight)</span>
<span class="g g-Whitespace">    </span><span class="mi">385</span>             <span class="c1"># parallel_backend contexts set at a higher level,</span>
<span class="g g-Whitespace">    </span><span class="mi">386</span>             <span class="c1"># since correctness does not rely on using threads.</span>
<span class="ne">--&gt; </span><span class="mi">387</span>             <span class="n">trees</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">388</span>                              <span class="o">**</span><span class="n">_joblib_parallel_args</span><span class="p">(</span><span class="n">prefer</span><span class="o">=</span><span class="s1">&#39;threads&#39;</span><span class="p">))(</span>
<span class="g g-Whitespace">    </span><span class="mi">389</span>                 <span class="n">delayed</span><span class="p">(</span><span class="n">_parallel_build_trees</span><span class="p">)(</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">   </span><span class="mi">1042</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_iterating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_iterator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1043</span> 
<span class="ne">-&gt; </span><span class="mi">1044</span>             <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_one_batch</span><span class="p">(</span><span class="n">iterator</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1045</span>                 <span class="k">pass</span>
<span class="g g-Whitespace">   </span><span class="mi">1046</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">dispatch_one_batch</span><span class="nt">(self, iterator)</span>
<span class="g g-Whitespace">    </span><span class="mi">857</span>                 <span class="k">return</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span>             <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">859</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_dispatch</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span>                 <span class="k">return</span> <span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">861</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">_dispatch</span><span class="nt">(self, batch)</span>
<span class="g g-Whitespace">    </span><span class="mi">775</span>         <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">776</span>             <span class="n">job_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_jobs</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">777</span>             <span class="n">job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">cb</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">778</span>             <span class="c1"># A job can complete so quickly than its callback is</span>
<span class="g g-Whitespace">    </span><span class="mi">779</span>             <span class="c1"># called before we get here, causing self._jobs to</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\_parallel_backends.py</span> in <span class="ni">apply_async</span><span class="nt">(self, func, callback)</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>     <span class="k">def</span> <span class="nf">apply_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span><span class="w">         </span><span class="sd">&quot;&quot;&quot;Schedule a func to be run&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">208</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">ImmediateResult</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span>         <span class="k">if</span> <span class="n">callback</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span>             <span class="n">callback</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\_parallel_backends.py</span> in <span class="ni">__init__</span><span class="nt">(self, batch)</span>
<span class="g g-Whitespace">    </span><span class="mi">570</span>         <span class="c1"># Don&#39;t delay the application, to avoid keeping the input</span>
<span class="g g-Whitespace">    </span><span class="mi">571</span>         <span class="c1"># arguments in memory</span>
<span class="ne">--&gt; </span><span class="mi">572</span>         <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">batch</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">573</span> 
<span class="g g-Whitespace">    </span><span class="mi">574</span>     <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">__call__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="c1"># change the default number of processes to -1</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="k">with</span> <span class="n">parallel_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_jobs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">262</span>             <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span>                     <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="c1"># change the default number of processes to -1</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="k">with</span> <span class="n">parallel_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_jobs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">262</span>             <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span>                     <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\utils\fixes.py</span> in <span class="ni">__call__</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>     <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>         <span class="k">with</span> <span class="n">config_context</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">222</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\ensemble\_forest.py</span> in <span class="ni">_parallel_build_trees</span><span class="nt">(tree, forest, X, y, sample_weight, tree_idx, n_trees, verbose, class_weight, n_samples_bootstrap)</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span>         <span class="n">tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">curr_sample_weight</span><span class="p">,</span> <span class="n">check_input</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">171</span>         <span class="n">tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">check_input</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">172</span> 
<span class="g g-Whitespace">    </span><span class="mi">173</span>     <span class="k">return</span> <span class="n">tree</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\tree\_classes.py</span> in <span class="ni">fit</span><span class="nt">(self, X, y, sample_weight, check_input, X_idx_sorted)</span>
<span class="g g-Whitespace">    </span><span class="mi">896</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">897</span><span class="s2"> </span>
<span class="ne">--&gt; </span><span class="mi">898</span><span class="s2">         super().fit(</span>
<span class="g g-Whitespace">    </span><span class="mi">899</span><span class="s2">             X, y,</span>
<span class="g g-Whitespace">    </span><span class="mi">900</span><span class="s2">             sample_weight=sample_weight,</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\tree\_classes.py</span> in <span class="ni">fit</span><span class="nt">(self, X, y, sample_weight, check_input, X_idx_sorted)</span>
<span class="g g-Whitespace">    </span><span class="mi">387</span><span class="s2">                                            min_impurity_split)</span>
<span class="g g-Whitespace">    </span><span class="mi">388</span><span class="s2"> </span>
<span class="ne">--&gt; </span><span class="mi">389</span><span class="s2">         builder.build(self.tree_, X, y, sample_weight)</span>
<span class="g g-Whitespace">    </span><span class="mi">390</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">391</span><span class="s2">         if self.n_outputs_ == 1 and is_classifier(self):</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
</section>
<section id="random-forest">
<h2>random forest<a class="headerlink" href="#random-forest" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">make_scorer</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="n">SEED</span> <span class="o">=</span> <span class="mi">23</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>  <span class="c1"># https://scikit-learn.org/stable/modules/feature_selection.html</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
              <span class="s2">&quot;max_features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
              <span class="s2">&quot;min_samples_split&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
              <span class="s2">&quot;min_samples_leaf&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
              <span class="s2">&quot;n_estimators&quot;</span> <span class="p">:[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
              <span class="s2">&quot;criterion&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;gini&quot;</span><span class="p">]}</span>

<span class="n">grid_dt_estimator</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> 
                                                 <span class="n">param_grid</span><span class="p">,</span>
                                                 <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">,</span> 
                                                 <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                 <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                                                 <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">grid_dt_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="c1"># RandomForestClassifier(criterion=&#39;gini&#39;, max_features=11,</span>
<span class="c1">#                        min_samples_leaf=1, min_samples_split=2, n_estimators=200, random_state=SEED)</span>

<span class="c1"># 0.9950857839601017</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="logistic-regression">
<h2>logistic regression<a class="headerlink" href="#logistic-regression" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LR_model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;penalty&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l2&#39;</span><span class="p">],</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;max_iter&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">100</span><span class="p">)),</span>
<span class="p">}</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;penalty&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l2&#39;</span><span class="p">],</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="s1">&#39;max_iter&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">500</span><span class="p">]</span>
<span class="p">}</span>


<span class="n">LR_GridSearch</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">LR_model</span><span class="p">,</span> 
                              <span class="n">param_grid</span><span class="p">,</span> 
                              <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">,</span> 
                              <span class="n">cv</span><span class="o">=</span><span class="mi">10</span>
                              <span class="p">)</span>

<span class="n">LR_GridSearch</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">LR_GridSearch</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">LR_GridSearch</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span>

<span class="c1"># LogisticRegression(C=1, max_iter=200)</span>
<span class="c1"># 0.9914939568317609</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LogisticRegression(C=1, max_iter=500)
0.9914930891756072
</pre></div>
</div>
</div>
</div>
</section>
<section id="mlp">
<h2>MLP<a class="headerlink" href="#mlp" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">make_scorer</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>

<span class="n">SEED</span> <span class="o">=</span> <span class="mi">23</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>  <span class="c1"># https://scikit-learn.org/stable/modules/feature_selection.html</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;hidden_layer_sizes&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,)],</span>
    <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;tanh&#39;</span><span class="p">,</span> <span class="s1">&#39;relu&#39;</span><span class="p">],</span>
    <span class="s1">&#39;solver&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sgd&#39;</span><span class="p">,</span> <span class="s1">&#39;adam&#39;</span><span class="p">],</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span><span class="s1">&#39;adaptive&#39;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">grid_dt_estimator</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> 
                                                 <span class="n">param_grid</span><span class="p">,</span>
                                                 <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">,</span> 
                                                 <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                 <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                                                 <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">grid_dt_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="c1"># MLPClassifier(activation=&#39;relu&#39;, alpha=0.0001, batch_size=&#39;auto&#39;, beta_1=0.9,</span>
<span class="c1">#               beta_2=0.999, early_stopping=False, epsilon=1e-08,</span>
<span class="c1">#               hidden_layer_sizes=(50, 100, 50), learning_rate=&#39;adaptive&#39;,</span>
<span class="c1">#               learning_rate_init=0.001, max_fun=15000, max_iter=200,</span>
<span class="c1">#               momentum=0.9, n_iter_no_change=10, nesterovs_momentum=True,</span>
<span class="c1">#               power_t=0.5, random_state=23, shuffle=True, solver=&#39;adam&#39;,</span>
<span class="c1">#               tol=0.0001, validation_fraction=0.1, verbose=False,</span>
<span class="c1">#               warm_start=False)</span>
<span class="c1"># 0.98490141953081</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="testing-on-validation-set">
<h1>Testing on validation set<a class="headerlink" href="#testing-on-validation-set" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;X_val.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="c1"># ignore first row</span>
<span class="n">y_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;y_val.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="xgboost">
<h2>XGboost<a class="headerlink" href="#xgboost" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://www.datacamp.com/community/tutorials/xgboost-in-python</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>
<span class="n">xgb_test</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;mlogloss&#39;</span><span class="p">)</span>

<span class="n">xgb_test</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">xgb_test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         1.0       1.00      0.99      0.99       512
         2.0       0.99      0.99      0.99       552
         3.0       1.00      0.98      0.99       327
         4.0       0.99      0.99      0.99       408
         5.0       0.99      1.00      0.99       622
         6.0       0.99      0.99      0.99       361

    accuracy                           0.99      2782
   macro avg       0.99      0.99      0.99      2782
weighted avg       0.99      0.99      0.99      2782

0.9917276957950154
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">xgb_test</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train dataset: &quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">457</span><span class="o">-</span><span class="mf">4915e574</span><span class="n">b577</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">results</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">xgb_test</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train dataset: &quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\utils\validation.py</span> in <span class="ni">inner_f</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span>             <span class="n">extra_args</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_args</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span>             <span class="k">if</span> <span class="n">extra_args</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">63</span>                 <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> 
<span class="g g-Whitespace">     </span><span class="mi">65</span>             <span class="c1"># extra_args &gt; 0</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\model_selection\_validation.py</span> in <span class="ni">cross_val_score</span><span class="nt">(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, error_score)</span>
<span class="g g-Whitespace">    </span><span class="mi">438</span>     <span class="n">scorer</span> <span class="o">=</span> <span class="n">check_scoring</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span> 
<span class="ne">--&gt; </span><span class="mi">440</span>     <span class="n">cv_results</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span>                                 <span class="n">scoring</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="n">scorer</span><span class="p">},</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">442</span>                                 <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\utils\validation.py</span> in <span class="ni">inner_f</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span>             <span class="n">extra_args</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_args</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span>             <span class="k">if</span> <span class="n">extra_args</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">63</span>                 <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> 
<span class="g g-Whitespace">     </span><span class="mi">65</span>             <span class="c1"># extra_args &gt; 0</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\model_selection\_validation.py</span> in <span class="ni">cross_validate</span><span class="nt">(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, return_train_score, return_estimator, error_score)</span>
<span class="g g-Whitespace">    </span><span class="mi">244</span>     <span class="n">parallel</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">245</span>                         <span class="n">pre_dispatch</span><span class="o">=</span><span class="n">pre_dispatch</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">246</span>     <span class="n">results</span> <span class="o">=</span> <span class="n">parallel</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">247</span>         <span class="n">delayed</span><span class="p">(</span><span class="n">_fit_and_score</span><span class="p">)(</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span>             <span class="n">clone</span><span class="p">(</span><span class="n">estimator</span><span class="p">),</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scorers</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">   </span><span class="mi">1042</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_iterating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_iterator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1043</span> 
<span class="ne">-&gt; </span><span class="mi">1044</span>             <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_one_batch</span><span class="p">(</span><span class="n">iterator</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1045</span>                 <span class="k">pass</span>
<span class="g g-Whitespace">   </span><span class="mi">1046</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">dispatch_one_batch</span><span class="nt">(self, iterator)</span>
<span class="g g-Whitespace">    </span><span class="mi">857</span>                 <span class="k">return</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span>             <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">859</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_dispatch</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span>                 <span class="k">return</span> <span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">861</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">_dispatch</span><span class="nt">(self, batch)</span>
<span class="g g-Whitespace">    </span><span class="mi">775</span>         <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">776</span>             <span class="n">job_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_jobs</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">777</span>             <span class="n">job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">cb</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">778</span>             <span class="c1"># A job can complete so quickly than its callback is</span>
<span class="g g-Whitespace">    </span><span class="mi">779</span>             <span class="c1"># called before we get here, causing self._jobs to</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\_parallel_backends.py</span> in <span class="ni">apply_async</span><span class="nt">(self, func, callback)</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>     <span class="k">def</span> <span class="nf">apply_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span><span class="w">         </span><span class="sd">&quot;&quot;&quot;Schedule a func to be run&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">208</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">ImmediateResult</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span>         <span class="k">if</span> <span class="n">callback</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span>             <span class="n">callback</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\_parallel_backends.py</span> in <span class="ni">__init__</span><span class="nt">(self, batch)</span>
<span class="g g-Whitespace">    </span><span class="mi">570</span>         <span class="c1"># Don&#39;t delay the application, to avoid keeping the input</span>
<span class="g g-Whitespace">    </span><span class="mi">571</span>         <span class="c1"># arguments in memory</span>
<span class="ne">--&gt; </span><span class="mi">572</span>         <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">batch</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">573</span> 
<span class="g g-Whitespace">    </span><span class="mi">574</span>     <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">__call__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="c1"># change the default number of processes to -1</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="k">with</span> <span class="n">parallel_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_jobs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">262</span>             <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span>                     <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\joblib\parallel.py</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="c1"># change the default number of processes to -1</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="k">with</span> <span class="n">parallel_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_jobs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">262</span>             <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span>                     <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span> 

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\utils\fixes.py</span> in <span class="ni">__call__</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>     <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>         <span class="k">with</span> <span class="n">config_context</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">222</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\sklearn\model_selection\_validation.py</span> in <span class="ni">_fit_and_score</span><span class="nt">(estimator, X, y, scorer, train, test, verbose, parameters, fit_params, return_train_score, return_parameters, return_n_test_samples, return_times, return_estimator, split_progress, candidate_progress, error_score)</span>
<span class="g g-Whitespace">    </span><span class="mi">591</span>             <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">592</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">593</span>             <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">594</span> 
<span class="g g-Whitespace">    </span><span class="mi">595</span>     <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\xgboost\core.py</span> in <span class="ni">inner_f</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">431</span>         <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">432</span>             <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span>
<span class="ne">--&gt; </span><span class="mi">433</span>         <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">434</span> 
<span class="g g-Whitespace">    </span><span class="mi">435</span>     <span class="k">return</span> <span class="n">inner_f</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\xgboost\sklearn.py</span> in <span class="ni">fit</span><span class="nt">(self, X, y, sample_weight, base_margin, eval_set, eval_metric, early_stopping_rounds, verbose, xgb_model, sample_weight_eval_set, base_margin_eval_set, feature_weights, callbacks)</span>
<span class="g g-Whitespace">   </span><span class="mi">1174</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1175</span> 
<span class="ne">-&gt; </span><span class="mi">1176</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_Booster</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1177</span>             <span class="n">params</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1178</span>             <span class="n">train_dmatrix</span><span class="p">,</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\xgboost\training.py</span> in <span class="ni">train</span><span class="nt">(params, dtrain, num_boost_round, evals, obj, feval, maximize, early_stopping_rounds, evals_result, verbose_eval, xgb_model, callbacks)</span>
<span class="g g-Whitespace">    </span><span class="mi">187</span>     <span class="n">Booster</span> <span class="p">:</span> <span class="n">a</span> <span class="n">trained</span> <span class="n">booster</span> <span class="n">model</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span>     <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">189</span><span class="s2">     bst = _train_internal(params, dtrain,</span>
<span class="g g-Whitespace">    </span><span class="mi">190</span><span class="s2">                           num_boost_round=num_boost_round,</span>
<span class="g g-Whitespace">    </span><span class="mi">191</span><span class="s2">                           evals=evals,</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\xgboost\training.py</span> in <span class="ni">_train_internal</span><span class="nt">(params, dtrain, num_boost_round, evals, obj, feval, xgb_model, callbacks, evals_result, maximize, verbose_eval, early_stopping_rounds)</span>
<span class="g g-Whitespace">     </span><span class="mi">79</span><span class="s2">         if callbacks.before_iteration(bst, i, dtrain, evals):</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span><span class="s2">             break</span>
<span class="ne">---&gt; </span><span class="mi">81</span><span class="s2">         bst.update(dtrain, i, obj)</span>
<span class="g g-Whitespace">     </span><span class="mi">82</span><span class="s2">         if callbacks.after_iteration(bst, i, dtrain, evals):</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span><span class="s2">             break</span>

<span class="nn">c:\users\jerrw\appdata\local\programs\python\python38\lib\site-packages\xgboost\core.py</span> in <span class="ni">update</span><span class="nt">(self, dtrain, iteration, fobj)</span>
<span class="g g-Whitespace">   </span><span class="mi">1494</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1495</span><span class="s2">         if fobj is None:</span>
<span class="ne">-&gt; </span><span class="mi">1496</span><span class="s2">             _check_call(_LIB.XGBoosterUpdateOneIter(self.handle,</span>
<span class="g g-Whitespace">   </span><span class="mi">1497</span><span class="s2">                                                     ctypes.c_int(iteration),</span>
<span class="g g-Whitespace">   </span><span class="mi">1498</span><span class="s2">                                                     dtrain.handle))</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;min_child_weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
        <span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2>extra tree<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extra_tree_test</span> <span class="o">=</span> <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>

<span class="n">extra_tree_test</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">extra_tree_test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         1.0       1.00      0.99      0.99       512
         2.0       0.99      0.99      0.99       552
         3.0       1.00      0.98      0.99       327
         4.0       1.00      1.00      1.00       408
         5.0       0.99      1.00      0.99       622
         6.0       1.00      0.99      1.00       361

    accuracy                           0.99      2782
   macro avg       0.99      0.99      0.99      2782
weighted avg       0.99      0.99      0.99      2782

0.9931659337721328
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ExtraTreesClassifier(criterion=&#39;gini&#39;, max_depth=None, min_samples_leaf=1, min_samples_split=2,n_estimators=300,random_state=SEED)</span>
<span class="n">extra_tree_test</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;Et&#39;</span> <span class="p">,</span> 
                            <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">))])</span>

<span class="n">extra_tree_test</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">extra_tree_test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         1.0       1.00      0.99      0.99       512
         2.0       0.99      0.99      0.99       552
         3.0       1.00      0.98      0.99       327
         4.0       1.00      1.00      1.00       408
         5.0       0.99      1.00      0.99       622
         6.0       1.00      0.99      1.00       361

    accuracy                           0.99      2782
   macro avg       0.99      0.99      0.99      2782
weighted avg       0.99      0.99      0.99      2782

0.9931659337721328
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train dataset: &quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train dataset:  0.9950861666716623
</pre></div>
</div>
</div>
</div>
<section id="visulisation">
<h3>visulisation<a class="headerlink" href="#visulisation" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">export_graphviz</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># Extract single tree</span>
<span class="n">et_single</span> <span class="o">=</span> <span class="n">extra_tree_test</span><span class="o">.</span><span class="n">estimators_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">(</span><span class="n">et_single</span><span class="p">,</span>
               <span class="n">feature_names</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> 
               <span class="c1">#class_names=[i for i in range (1, 7)],</span>
               <span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">tmp</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;et_individualtree1.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/94c8abe5444448f261810d09223d07e822089cde3dc0cc140bd620398379e107.png" src="../../../_images/94c8abe5444448f261810d09223d07e822089cde3dc0cc140bd620398379e107.png" />
</div>
</div>
</section>
</section>
<section id="id2">
<h2>random forest<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_forest_test</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_features</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span> 

<span class="n">random_forest_test</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">random_forest_test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         1.0       1.00      0.99      1.00       512
         2.0       0.99      0.99      0.99       552
         3.0       0.99      0.97      0.98       327
         4.0       0.99      1.00      0.99       408
         5.0       0.99      0.99      0.99       622
         6.0       0.99      0.99      0.99       361

    accuracy                           0.99      2782
   macro avg       0.99      0.99      0.99      2782
weighted avg       0.99      0.99      0.99      2782

0.9910056181525955
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">random_forest_test</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train dataset: &quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train dataset:  0.9940058937662787
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from sklearn.tree import export_graphviz</span>
<span class="c1"># from sklearn import tree</span>
<span class="c1"># import os</span>
<span class="c1"># # Extract single tree</span>
<span class="c1"># rf_single = random_forest_test.estimators_[0]</span>

<span class="c1"># fig, axes = plt.subplots(nrows = 1,ncols = 1,figsize = (4,4), dpi=800)</span>
<span class="c1"># tree.plot_tree(rf_single,</span>
<span class="c1">#                feature_names = X_train.columns, </span>
<span class="c1">#                #class_names=[i for i in range (1, 7)],</span>
<span class="c1">#                filled = True)</span>
<span class="c1"># fig.savefig(&#39;rf_individualtree.png&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/94a2b0b9cc7fa433dff544b8c2b2e5de401a54588a306215549692950eedbdf6.png" src="../../../_images/94a2b0b9cc7fa433dff544b8c2b2e5de401a54588a306215549692950eedbdf6.png" />
</div>
</div>
</section>
<section id="id3">
<h2>MLP<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mlp_tmp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">beta_1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
              <span class="n">beta_2</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">early_stopping</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span>
              <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;adaptive&#39;</span><span class="p">,</span>
              <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_fun</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
              <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">n_iter_no_change</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nesterovs_momentum</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">power_t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
              <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">validation_fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">MLP_test</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;MLP&#39;</span> <span class="p">,</span><span class="n">mlp_tmp</span><span class="p">)])</span> 
<span class="n">MLP_test</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">MLP_test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         1.0       1.00      1.00      1.00       512
         2.0       0.99      0.99      0.99       552
         3.0       1.00      0.98      0.99       327
         4.0       0.99      1.00      0.99       408
         5.0       0.99      1.00      0.99       622
         6.0       1.00      0.99      0.99       361

    accuracy                           0.99      2782
   macro avg       0.99      0.99      0.99      2782
weighted avg       0.99      0.99      0.99      2782

0.9931671746045143
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">MLP_test</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train dataset: &quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train dataset:  0.9928145296846864
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h2>KNN<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">KNN_test</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;LDA&#39;</span> <span class="p">,</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">))])</span> 
<span class="n">KNN_test</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">KNN_test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         1.0       1.00      0.99      0.99       512
         2.0       0.98      1.00      0.99       552
         3.0       1.00      0.98      0.99       327
         4.0       1.00      1.00      1.00       408
         5.0       0.99      0.99      0.99       622
         6.0       0.99      0.99      0.99       361

    accuracy                           0.99      2782
   macro avg       0.99      0.99      0.99      2782
weighted avg       0.99      0.99      0.99      2782

0.9928072528327913
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">KNN_test</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train dataset: &quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train dataset:  0.9949674116158723
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h2>Logistic Regression<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LR_test</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;LDA&#39;</span> <span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">))])</span> <span class="c1"># LogisticRegression(C=1, max_iter=500) # 1 prob</span>
<span class="n">LR_test</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">LR_test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         1.0       1.00      0.98      0.99       512
         2.0       0.99      0.99      0.99       552
         3.0       0.99      0.97      0.98       327
         4.0       0.98      0.99      0.99       408
         5.0       0.98      0.99      0.99       622
         6.0       0.99      0.99      0.99       361

    accuracy                           0.99      2782
   macro avg       0.99      0.99      0.99      2782
weighted avg       0.99      0.99      0.99      2782

0.9870539710284344
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="voting-ensemble">
<h1>Voting ensemble<a class="headerlink" href="#voting-ensemble" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">VotingClassifier</span>

<span class="n">param</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">model2</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">param</span><span class="p">)</span>

<span class="n">model3</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;MLP&#39;</span> <span class="p">,</span><span class="n">MLPClassifier</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">beta_1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
              <span class="n">beta_2</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">early_stopping</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span>
              <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;adaptive&#39;</span><span class="p">,</span>
              <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_fun</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
              <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">n_iter_no_change</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nesterovs_momentum</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">power_t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
              <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">validation_fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">))])</span> 

<span class="n">model4</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>

<span class="n">model5</span> <span class="o">=</span> <span class="n">ExtraTreesClassifier</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="knn-mlp-rf-et">
<h2>KNN + MLP + RF + ET<a class="headerlink" href="#knn-mlp-rf-et" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">estimators</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span><span class="n">model2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;MLP&#39;</span><span class="p">,</span><span class="n">model3</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;RF&#39;</span><span class="p">,</span><span class="n">model4</span><span class="p">),</span>  <span class="p">(</span><span class="s1">&#39;ET&#39;</span><span class="p">,</span><span class="n">model5</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the ensemble model</span>
<span class="n">kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ensemble</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="p">)</span> <span class="c1"># argument &quot;soft&quot; to the voting parameter to take into account the probability of each vote.</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">)</span>
<span class="n">ensemble_model</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">ensemble_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train dataset: &quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Evalution dataset: &quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         1.0       1.00      0.99      1.00       512
         2.0       0.99      1.00      0.99       552
         3.0       0.99      0.98      0.99       327
         4.0       0.99      1.00      0.99       408
         5.0       0.99      1.00      0.99       622
         6.0       1.00      0.99      1.00       361

    accuracy                           0.99      2782
   macro avg       0.99      0.99      0.99      2782
weighted avg       0.99      0.99      0.99      2782

Train dataset:  mean 0.9952060060474208 var 0.0015165522265544397
Evalution dataset:  0.9931707068184391
</pre></div>
</div>
</div>
</div>
</section>
<section id="rf-et-mlp-not-used">
<h2>RF + ET + MLP (not used)<a class="headerlink" href="#rf-et-mlp-not-used" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">estimators</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;MLP&#39;</span><span class="p">,</span><span class="n">model3</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;RF&#39;</span><span class="p">,</span><span class="n">model4</span><span class="p">),</span>  <span class="p">(</span><span class="s1">&#39;ET&#39;</span><span class="p">,</span><span class="n">model5</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the ensemble model</span>
<span class="n">kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ensemble</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="p">)</span> <span class="c1"># argument &quot;soft&quot; to the voting parameter to take into account the probability of each vote.</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1_weighted&quot;</span><span class="p">)</span>
<span class="n">ensemble_model</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">ensemble_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train dataset: &quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Evalution dataset: &quot;</span><span class="p">,</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         1.0       1.00      0.99      1.00       512
         2.0       0.99      0.99      0.99       552
         3.0       1.00      0.98      0.99       327
         4.0       1.00      1.00      1.00       408
         5.0       0.99      1.00      0.99       622
         6.0       1.00      0.99      1.00       361

    accuracy                           0.99      2782
   macro avg       0.99      0.99      0.99      2782
weighted avg       0.99      0.99      0.99      2782

Train dataset:  0.9956851357892544
Evalution dataset:  0.9931691564574779
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="submit-model-used-voting-ensemble-knn-mlp-rf-et">
<h1>Submit - model used: voting ensemble (KNN + MLP + RF + ET)<a class="headerlink" href="#submit-model-used-voting-ensemble-knn-mlp-rf-et" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extra_tree_test</span> <span class="o">=</span> <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>

<span class="n">extra_tree_test</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">extra_tree_test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         1.0       1.00      0.99      0.99       512
         2.0       0.99      0.99      0.99       552
         3.0       1.00      0.98      0.99       327
         4.0       1.00      1.00      1.00       408
         5.0       0.99      1.00      0.99       622
         6.0       1.00      0.99      1.00       361

    accuracy                           0.99      2782
   macro avg       0.99      0.99      0.99      2782
weighted avg       0.99      0.99      0.99      2782

0.9931659337721328
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;X_test.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="c1"># ignore first row</span>
</pre></div>
</div>
</div>
</div>
<section id="compare-extra-tree-with-voting-ensemble">
<h2>compare extra tree with voting ensemble<a class="headerlink" href="#compare-extra-tree-with-voting-ensemble" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model1</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;MLP&#39;</span> <span class="p">,</span><span class="n">MLPClassifier</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">beta_1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
              <span class="n">beta_2</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">early_stopping</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span>
              <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;adaptive&#39;</span><span class="p">,</span>
              <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_fun</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
              <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">n_iter_no_change</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nesterovs_momentum</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">power_t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
              <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">validation_fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">))])</span> 

<span class="n">model2</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>

<span class="n">model3</span> <span class="o">=</span> <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">model4</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;Scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),(</span><span class="s1">&#39;LDA&#39;</span> <span class="p">,</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">))])</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">estimators</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;MLP&#39;</span><span class="p">,</span><span class="n">model1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;RF&#39;</span><span class="p">,</span><span class="n">model2</span><span class="p">),</span>  <span class="p">(</span><span class="s1">&#39;ET&#39;</span><span class="p">,</span><span class="n">model3</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span> <span class="n">model4</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_check</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extra_tree_test</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">extra_tree_test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_check</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">y_pred_check</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">test_check</span><span class="p">[</span><span class="n">test_check</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
<span class="n">diff_perc</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="n">total</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diff_perc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2779
2782
0.998921639108555
</pre></div>
</div>
</div>
</div>
</section>
<section id="csv">
<h2>csv<a class="headerlink" href="#csv" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prediction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_pred_check</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;y_test.csv&#39;</span> <span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ds-courses\unsw\9417"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="9417-basic.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Basic with examples</p>
      </div>
    </a>
    <a class="right-next"
       href="9417-report/report.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Project - report</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Project - Classification</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-data">Explore data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-info">basic info</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values-boxplot-for-data">missing values, boxplot for data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#five-feature-pairwise-plot">five feature pairwise plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">boxplot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pie-chart-for-class-distribution">pie chart for class distribution</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-comparison">Model comparison</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-code">setup code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basedline-score">basedline score</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standarised-scores-0-mean">standarised scores (0 mean)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-result-for-final-model-choices">display result for final model choices</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-selection">Feature selection</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#features-correlation">features correlation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlated-with-y">correlated with y</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importance-using-extra-forest">Feature Importance using extra forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-based-feature-selection">Tree-based feature selection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-svm">linear SVM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pca">PCA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-comparison-using-pca">performance comparison using PCA</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anova-f-test">ANOVA f-test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-square-test">chi-square test</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-outlier">Remove Outlier</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#isolation-forest">Isolation forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dbscan">DBSCAN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interquatile-range">Interquatile range</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-using-interqutertile">filter using interqutertile</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot-after-outlier-removal">boxplot after outlier removal</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-tuning">Parameter tuning</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">KNN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-tree">extra tree</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest">random forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">logistic regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mlp">MLP</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-on-validation-set">Testing on validation set</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGboost</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">extra tree</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visulisation">visulisation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">random forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">MLP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">KNN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Logistic Regression</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#voting-ensemble">Voting ensemble</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn-mlp-rf-et">KNN + MLP + RF + ET</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rf-et-mlp-not-used">RF + ET + MLP (not used)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-model-used-voting-ensemble-knn-mlp-rf-et">Submit - model used: voting ensemble (KNN + MLP + RF + ET)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-extra-tree-with-voting-ensemble">compare extra tree with voting ensemble</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#csv">csv</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jerry
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>